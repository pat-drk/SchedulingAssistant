import{a2 as St,r as u,a3 as _t,a4 as qt,a5 as At,a6 as Se,m as ze,a7 as Ot,b as wt,a8 as Ht,a9 as Mt,aa as Ft,ab as Lt,a as Me,ac as It,ad as Wt,ae as $t,af as Vt,j as Ye,h as je,i as he,n as e,z as X,s as T,X as fe,Y as ue,Z as K,$ as C,a0 as me,a1 as D,ag as ee,I as Z,L as Be,Q as pe,t as i,y as yt,B as kt,ah as Pt,ai as Ut,aj as Et,A as _e,F as we,G as ye,H as ke,J as Ee,ak as ve,al as st,U as Nt,K as Ne,D as le,O as J,W as Gt,am as lt,an as Je,ao as be,ap as Ze,aq as Xt,ar as Yt,as as Jt,q as ct,E as Zt,at as dt,au as Kt,R as se,av as $e,aw as Bt,ax as Qt,ay as eo,az as to,aA as oo,aB as ro,C as ft,aC as Ke,aD as io,aE as no}from"./index-CWU0J6Yg.js";import{A as ao}from"./AutoFillSettings-CAfQNIvE.js";const ut=(t,o,s)=>Math.max(o,Math.min(s,t||0));function so(t,o){const{checked:s,defaultChecked:r,disabled:l,disabledFocusable:p}=t,{onClick:j,role:_}=o.root,[c,h]=St({state:s,defaultState:r,initialState:!1}),S=_==="menuitemcheckbox"||_==="checkbox",g=u.useCallback(n=>{if(!l&&!p){if(n.defaultPrevented)return;h(!c)}},[c,l,p,h]);return{...o,checked:c,root:{...o.root,[S?"aria-checked":"aria-pressed"]:c,onClick:_t(qt(j,g))}}}const lo=(t,o)=>{const s=At(t,o);return so(t,s)},mt={root:"fui-ToggleButton",icon:"fui-ToggleButton__icon"},co=Se({base:{De3pzq:"f1nfm20t",g2u3we:"fj3muxo",h3c5rm:["f1akhkt","f1lxtadh"],B9xav0g:"f1aperda",zhjwy3:["f1lxtadh","f1akhkt"],sj55zd:"f14nttnl",B4j52fo:"f192inf7",Bekrc4i:["f5tn483","f1ojsxk5"],Bn0qgzm:"f1vxd6vx",ibv6hh:["f1ojsxk5","f5tn483"],D0sxk3:"fxoiby5",t6yez3:"f15q0o9g",Jwef8y:"f1knas48",Bgoe8wy:"fvcxoqz",Bwzppfd:["f1ub3y4t","f1m52nbi"],oetu4i:"f1xlaoq0",gg5e9n:["f1m52nbi","f1ub3y4t"],Bi91k9c:"feu1g3u",Bpjbzib:"f128kf1x",im15vp:"f1a38rnh",Hjvxdg:["f1wvuwkr","fbu0tau"],Gpfmf1:"f132k7zb",ustxxc:["fbu0tau","f1wvuwkr"],Brsut9c:"fggfoek"},highContrast:{By8wz76:"f1nz3ub2",Bcq6wej:"fjq791v",Jcjdmf:["fkq2p2y","f1sehlss"],sc4o1m:"f11odvng",Bosien3:["f1sehlss","fkq2p2y"],B7iucu3:"fqc85l4",B8gzw0y:"f1h3a8gf",Bbkh6qg:"fkiggi6",F230oe:"f8gmj8i",Bdw8ktp:["f1ap8nzx","fjag8bx"],Bj1xduy:"f1igan7k",Bhh2cfd:["fjag8bx","f1ap8nzx"],Bahaeuw:"f1v3eptx",Bv2bamp:"f1ysmecq",vxuvv6:"faulsx",Bli9q98:["f79t15f","f8qmx7k"],Bx2tt8t:"fbtzoaq",yad0b3:["f8qmx7k","f79t15f"],j2fop7:"fd4bjan",B6rz4yo:0,Buk7464:0,Bqg8rp8:0,pjr8j7:0,Bgs2klq:0,Hwei09:0,Bi9aqk7:0,Fihjvf:0,nhyz0p:0,Buw724y:0,Bn7qjfh:0,B0u7xl9:0,md97jv:0,h3ptyc:0,s1kvfj:0,kogrdj:0,dqx2i2:"fdmpsdn",o0nolc:"fgjsukj"},outline:{De3pzq:"f1q9pm1r",g2u3we:"fj3muxo",h3c5rm:["f1akhkt","f1lxtadh"],B9xav0g:"f1aperda",zhjwy3:["f1lxtadh","f1akhkt"],B4j52fo:"fgx37oo",Bekrc4i:["f130t4y6","f1efpmoh"],Bn0qgzm:"fv51ejd",ibv6hh:["f1efpmoh","f130t4y6"],Jwef8y:"fjxutwb",Bpjbzib:"fkoldzo",B8q5s1w:"fcaw57c",Bci5o5g:["fpwd27e","f1999bjr"],n8qw10:"f1hi52o4",Bdrgwmp:["f1999bjr","fpwd27e"]},primary:{De3pzq:"f8w4g0q",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"f1phragk",Jwef8y:"f15wkkf3",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"f1rq72xc",Bpjbzib:"f1ksv2xa",im15vp:"fhvnf4x",Hjvxdg:["fb6swo4","f232fm2"],Gpfmf1:"f1klyf7k",ustxxc:["f232fm2","fb6swo4"],Brsut9c:"f1d6mv4x"},secondary:{},subtle:{De3pzq:"fq5gl1p",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"f1eryozh",Jwef8y:"f1t94bn6",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"fnwyq0v",Bpjbzib:"f1q1yqic",im15vp:"fhvnf4x",Hjvxdg:["fb6swo4","f232fm2"],Gpfmf1:"f1klyf7k",ustxxc:["f232fm2","fb6swo4"],Brsut9c:"fwga7ee"},transparent:{De3pzq:"f1q9pm1r",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"f1qj7y59",Jwef8y:"fjxutwb",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"f139oj5f",Bpjbzib:"fkoldzo",im15vp:"fhvnf4x",Hjvxdg:["fb6swo4","f232fm2"],Gpfmf1:"f1klyf7k",ustxxc:["f232fm2","fb6swo4"],Brsut9c:"f1l983o9"}},{d:[".f1nfm20t{background-color:var(--colorNeutralBackground1Selected);}",".fj3muxo{border-top-color:var(--colorNeutralStroke1);}",".f1akhkt{border-right-color:var(--colorNeutralStroke1);}",".f1lxtadh{border-left-color:var(--colorNeutralStroke1);}",".f1aperda{border-bottom-color:var(--colorNeutralStroke1);}",".f14nttnl{color:var(--colorNeutralForeground1Selected);}",".f192inf7{border-top-width:var(--strokeWidthThin);}",".f5tn483{border-right-width:var(--strokeWidthThin);}",".f1ojsxk5{border-left-width:var(--strokeWidthThin);}",".f1vxd6vx{border-bottom-width:var(--strokeWidthThin);}",".fxoiby5 .fui-Icon-filled{display:inline;}",".f15q0o9g .fui-Icon-regular{display:none;}",".f1q9pm1r{background-color:var(--colorTransparentBackgroundSelected);}",".fgx37oo{border-top-width:var(--strokeWidthThicker);}",".f130t4y6{border-right-width:var(--strokeWidthThicker);}",".f1efpmoh{border-left-width:var(--strokeWidthThicker);}",".fv51ejd{border-bottom-width:var(--strokeWidthThicker);}",".fcaw57c[data-fui-focus-visible]{border-top-color:var(--colorNeutralStroke1);}",".fpwd27e[data-fui-focus-visible]{border-right-color:var(--colorNeutralStroke1);}",".f1999bjr[data-fui-focus-visible]{border-left-color:var(--colorNeutralStroke1);}",".f1hi52o4[data-fui-focus-visible]{border-bottom-color:var(--colorNeutralStroke1);}",".f8w4g0q{background-color:var(--colorBrandBackgroundSelected);}",".f1p3nwhy{border-top-color:transparent;}",".f11589ue{border-right-color:transparent;}",".f1pdflbu{border-left-color:transparent;}",".f1q5o8ev{border-bottom-color:transparent;}",".f1phragk{color:var(--colorNeutralForegroundOnBrand);}",".fq5gl1p{background-color:var(--colorSubtleBackgroundSelected);}",".f1eryozh{color:var(--colorNeutralForeground2Selected);}",".f1qj7y59{color:var(--colorNeutralForeground2BrandSelected);}"],h:[".f1knas48:hover{background-color:var(--colorNeutralBackground1Hover);}",".fvcxoqz:hover{border-top-color:var(--colorNeutralStroke1Hover);}",".f1ub3y4t:hover{border-right-color:var(--colorNeutralStroke1Hover);}",".f1m52nbi:hover{border-left-color:var(--colorNeutralStroke1Hover);}",".f1xlaoq0:hover{border-bottom-color:var(--colorNeutralStroke1Hover);}",".feu1g3u:hover{color:var(--colorNeutralForeground1Hover);}",".f128kf1x:hover:active,.f128kf1x:active:focus-visible{background-color:var(--colorNeutralBackground1Pressed);}",".f1a38rnh:hover:active,.f1a38rnh:active:focus-visible{border-top-color:var(--colorNeutralStroke1Pressed);}",".f1wvuwkr:hover:active,.f1wvuwkr:active:focus-visible{border-right-color:var(--colorNeutralStroke1Pressed);}",".fbu0tau:hover:active,.fbu0tau:active:focus-visible{border-left-color:var(--colorNeutralStroke1Pressed);}",".f132k7zb:hover:active,.f132k7zb:active:focus-visible{border-bottom-color:var(--colorNeutralStroke1Pressed);}",".fggfoek:hover:active,.fggfoek:active:focus-visible{color:var(--colorNeutralForeground1Pressed);}",".fjxutwb:hover{background-color:var(--colorTransparentBackgroundHover);}",".fkoldzo:hover:active,.fkoldzo:active:focus-visible{background-color:var(--colorTransparentBackgroundPressed);}",".f15wkkf3:hover{background-color:var(--colorBrandBackgroundHover);}",".f1s2uweq:hover{border-top-color:transparent;}",".fr80ssc:hover{border-right-color:transparent;}",".fecsdlb:hover{border-left-color:transparent;}",".f1ukrpxl:hover{border-bottom-color:transparent;}",".f1rq72xc:hover{color:var(--colorNeutralForegroundOnBrand);}",".f1ksv2xa:hover:active,.f1ksv2xa:active:focus-visible{background-color:var(--colorBrandBackgroundPressed);}",".fhvnf4x:hover:active,.fhvnf4x:active:focus-visible{border-top-color:transparent;}",".fb6swo4:hover:active,.fb6swo4:active:focus-visible{border-right-color:transparent;}",".f232fm2:hover:active,.f232fm2:active:focus-visible{border-left-color:transparent;}",".f1klyf7k:hover:active,.f1klyf7k:active:focus-visible{border-bottom-color:transparent;}",".f1d6mv4x:hover:active,.f1d6mv4x:active:focus-visible{color:var(--colorNeutralForegroundOnBrand);}",".f1t94bn6:hover{background-color:var(--colorSubtleBackgroundHover);}",".fnwyq0v:hover{color:var(--colorNeutralForeground2Hover);}",".f1q1yqic:hover:active,.f1q1yqic:active:focus-visible{background-color:var(--colorSubtleBackgroundPressed);}",".fwga7ee:hover:active,.fwga7ee:active:focus-visible{color:var(--colorNeutralForeground2Pressed);}",".f139oj5f:hover{color:var(--colorNeutralForeground2BrandHover);}",".f1l983o9:hover:active,.f1l983o9:active:focus-visible{color:var(--colorNeutralForeground2BrandPressed);}"],m:[["@media (forced-colors: active){.f1nz3ub2{background-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fjq791v{border-top-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1sehlss{border-left-color:Highlight;}.fkq2p2y{border-right-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f11odvng{border-bottom-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fqc85l4{color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1h3a8gf{forced-color-adjust:none;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fkiggi6:hover{background-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f8gmj8i:hover{border-top-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ap8nzx:hover{border-right-color:Highlight;}.fjag8bx:hover{border-left-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1igan7k:hover{border-bottom-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1v3eptx:hover{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ysmecq:hover:active,.f1ysmecq:active:focus-visible{background-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.faulsx:hover:active,.faulsx:active:focus-visible{border-top-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f79t15f:hover:active,.f79t15f:active:focus-visible{border-right-color:Highlight;}.f8qmx7k:hover:active,.f8qmx7k:active:focus-visible{border-left-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fbtzoaq:hover:active,.fbtzoaq:active:focus-visible{border-bottom-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fd4bjan:hover:active,.fd4bjan:active:focus-visible{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fdmpsdn:focus{border:1px solid HighlightText;}}",{p:-2,m:"(forced-colors: active)"}],["@media (forced-colors: active){.fgjsukj:focus{outline-color:Highlight;}}",{m:"(forced-colors: active)"}]]}),fo=Se({base:{De3pzq:"f1bg9a2p",g2u3we:"f1jj8ep1",h3c5rm:["f15xbau","fy0fskl"],B9xav0g:"f4ikngz",zhjwy3:["fy0fskl","f15xbau"],sj55zd:"f1s2aq7o",Jwef8y:"f1falr9n",Bgoe8wy:"f12mpcsy",Bwzppfd:["f1gwvigk","f18rmfxp"],oetu4i:"f1jnshp0",gg5e9n:["f18rmfxp","f1gwvigk"],Bi91k9c:"fvgxktp",Bpjbzib:"f1jct5ie",im15vp:"f13txml0",Hjvxdg:["f1ncddno","f1axfvow"],Gpfmf1:"f1z04ada",ustxxc:["f1axfvow","f1ncddno"],Brsut9c:"f1uhomfy"},outline:{},primary:{g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],im15vp:"fhvnf4x",Hjvxdg:["fb6swo4","f232fm2"],Gpfmf1:"f1klyf7k",ustxxc:["f232fm2","fb6swo4"]},secondary:{},subtle:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Jwef8y:"fjxutwb",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bpjbzib:"fkoldzo",im15vp:"fhvnf4x",Hjvxdg:["fb6swo4","f232fm2"],Gpfmf1:"f1klyf7k",ustxxc:["f232fm2","fb6swo4"]},transparent:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Jwef8y:"fjxutwb",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bpjbzib:"fkoldzo",im15vp:"fhvnf4x",Hjvxdg:["fb6swo4","f232fm2"],Gpfmf1:"f1klyf7k",ustxxc:["f232fm2","fb6swo4"]}},{d:[".f1bg9a2p{background-color:var(--colorNeutralBackgroundDisabled);}",".f1jj8ep1{border-top-color:var(--colorNeutralStrokeDisabled);}",".f15xbau{border-right-color:var(--colorNeutralStrokeDisabled);}",".fy0fskl{border-left-color:var(--colorNeutralStrokeDisabled);}",".f4ikngz{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".f1p3nwhy{border-top-color:transparent;}",".f11589ue{border-right-color:transparent;}",".f1pdflbu{border-left-color:transparent;}",".f1q5o8ev{border-bottom-color:transparent;}",".f1c21dwh{background-color:var(--colorTransparentBackground);}"],h:[".f1falr9n:hover{background-color:var(--colorNeutralBackgroundDisabled);}",".f12mpcsy:hover{border-top-color:var(--colorNeutralStrokeDisabled);}",".f1gwvigk:hover{border-right-color:var(--colorNeutralStrokeDisabled);}",".f18rmfxp:hover{border-left-color:var(--colorNeutralStrokeDisabled);}",".f1jnshp0:hover{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".fvgxktp:hover{color:var(--colorNeutralForegroundDisabled);}",".f1jct5ie:hover:active,.f1jct5ie:active:focus-visible{background-color:var(--colorNeutralBackgroundDisabled);}",".f13txml0:hover:active,.f13txml0:active:focus-visible{border-top-color:var(--colorNeutralStrokeDisabled);}",".f1ncddno:hover:active,.f1ncddno:active:focus-visible{border-right-color:var(--colorNeutralStrokeDisabled);}",".f1axfvow:hover:active,.f1axfvow:active:focus-visible{border-left-color:var(--colorNeutralStrokeDisabled);}",".f1z04ada:hover:active,.f1z04ada:active:focus-visible{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".f1uhomfy:hover:active,.f1uhomfy:active:focus-visible{color:var(--colorNeutralForegroundDisabled);}",".f1s2uweq:hover{border-top-color:transparent;}",".fr80ssc:hover{border-right-color:transparent;}",".fecsdlb:hover{border-left-color:transparent;}",".f1ukrpxl:hover{border-bottom-color:transparent;}",".fhvnf4x:hover:active,.fhvnf4x:active:focus-visible{border-top-color:transparent;}",".fb6swo4:hover:active,.fb6swo4:active:focus-visible{border-right-color:transparent;}",".f232fm2:hover:active,.f232fm2:active:focus-visible{border-left-color:transparent;}",".f1klyf7k:hover:active,.f1klyf7k:active:focus-visible{border-bottom-color:transparent;}",".fjxutwb:hover{background-color:var(--colorTransparentBackgroundHover);}",".fkoldzo:hover:active,.fkoldzo:active:focus-visible{background-color:var(--colorTransparentBackgroundPressed);}"]}),uo=Se({subtleOrTransparent:{sj55zd:"f1qj7y59"},highContrast:{B8gzw0y:"f1dd5bof"}},{d:[".f1qj7y59{color:var(--colorNeutralForeground2BrandSelected);}"],m:[["@media (forced-colors: active){.f1dd5bof{forced-color-adjust:auto;}}",{m:"(forced-colors: active)"}]]}),mo=Se({base:{By8wz76:"f14ptb23",Bcq6wej:"fd7znuh",Jcjdmf:["f1wh4a04","f15h7fac"],sc4o1m:"f1f064oi",Bosien3:["f15h7fac","f1wh4a04"],B7iucu3:"f3ggph1",B8gzw0y:"f1dd5bof"},disabled:{Bcq6wej:"f9dbb4x",Jcjdmf:["f3qs60o","f5u9ap2"],sc4o1m:"fwd1oij",Bosien3:["f5u9ap2","f3qs60o"],B7iucu3:"f1cyfu5x",h3ptyc:"f19etb0b",Buw724y:["f4f984j","fw441p0"],Buk7464:"f3d22hf",Hwei09:["fw441p0","f4f984j"]}},{m:[["@media (forced-colors: active){.f14ptb23{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fd7znuh{border-top-color:ButtonBorder;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f15h7fac{border-left-color:ButtonBorder;}.f1wh4a04{border-right-color:ButtonBorder;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1f064oi{border-bottom-color:ButtonBorder;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f3ggph1{color:ButtonText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1dd5bof{forced-color-adjust:auto;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f9dbb4x{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f3qs60o{border-right-color:GrayText;}.f5u9ap2{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fwd1oij{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1cyfu5x{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f19etb0b:focus{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f4f984j:focus{border-right-color:GrayText;}.fw441p0:focus{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f3d22hf:focus{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}]]}),ho=t=>{"use no memo";const o=co(),s=fo(),r=uo(),l=mo(),{appearance:p,checked:j,disabled:_,disabledFocusable:c}=t;return t.root.className=ze(mt.root,p==="primary"&&l.base,p==="primary"&&(_||c)&&l.disabled,j&&o.base,j&&o.highContrast,p&&j&&o[p],(_||c)&&s.base,p&&(_||c)&&s[p],t.root.className),t.icon&&(t.icon.className=ze(mt.icon,j&&(p==="subtle"||p==="transparent")&&r.subtleOrTransparent,r.highContrast,t.icon.className)),Ot(t),t},Ct=u.forwardRef((t,o)=>{const s=lo(t,o);return ho(s),wt("useToggleButtonStyles_unstable")(s),Ht(s)});Ct.displayName="ToggleButton";const Fe={root:"fui-Slider",rail:"fui-Slider__rail",thumb:"fui-Slider__thumb",input:"fui-Slider__input"},go={sliderDirectionVar:"--fui-Slider--direction",sliderProgressVar:"--fui-Slider--progress",sliderStepsPercentVar:"--fui-Slider--steps-percent"},po=Se({root:{qhf8xq:"f10pi13n",mc9l5x:"fwk3njj",lpbzjs:"f1sdsnyy",Bt984gj:"f122n59",B7hvi0a:"f1oiokrs"},small:{Bi64ftq:"f1agqo6f",Bslxy2k:"f1mmvox9",Ba19x4e:"f1i7ztpd",sshi5w:"f1pha7fy"},medium:{Bi64ftq:"f1a78h9h",Bslxy2k:"fh1udnr",Ba19x4e:"fuok0yf",sshi5w:"f1nxs5xn"},horizontal:{Bf4jedk:"fyvtabn",wkccdc:"fgfd48t",Budl1dq:"f4t5rw1"},vertical:{sshi5w:"f1pzv1zu",wkccdc:"fktlcaf",Budl1dq:"fiadc6h"},enabled:{B7wi8oa:"f4l8x3l",B250r6j:"f671q34",Bpmy4es:"fvfzmw5",Buw9y6v:"faw1t00",Bq939m0:"fxdgx5",gjzr1t:"fii04fa",tg7hqu:"f36hzz8",qhf704:"fdjsfay",Blfvze:"f1fen33d",genz7u:"f1c6b0w1",Brgvh4e:"f1rq9b4z",Bsjyjqp:"f4xxiul"},disabled:{Bpmy4es:"foojseg",B7wi8oa:"f1lgdqhv",B250r6j:"f1veetlj",qhf704:"fn4acdm",Blfvze:"f4s8dx0",genz7u:"f1wil5xy"},focusIndicatorHorizontal:{Brovlpu:"ftqa4ok",B486eqv:"f2hkw1w",Bssx7fj:"f1b1k54r",uh7if5:["f4ne723","fqqcjud"],clntm0:"fh7aioi",Dlk2r6:["fqqcjud","f4ne723"],h6p2u:"f1ufm4qn",I6qiy5:["f1qnwcb4","fgrk5zm"],yzno9d:"fi52z01",By0wis0:["fgrk5zm","f1qnwcb4"],B2j2mmj:"ffht0p2",wigs8:"f1p0ul1q",pbfy6t:"f1c901ms",B0v4ure:"f1alokd7",Byrf0fs:0,Bsiemmq:0,Bwckmig:0,skfxo0:0,Iidy0u:0,B98u21t:0,Bvwlmkc:0,jo1ztg:0,Ba1iezr:0,Blmvk6g:0,B24cy0v:0,Bil7v7r:0,Br3gin4:0,nr063g:0,ghq09:0,Bbgo44z:0,Bseh09z:"fmj8fco",az1dzo:0,Ba3ybja:0,B6352mv:0,vppk2z:0,Biaj6j7:"f1iwowo3",B2pnrqr:"f1pffoy2",B29w5g4:["f1dfga45","f63jj3o"],Bhhzhcn:"fs6b7xr",Bec0n69:["f63jj3o","f1dfga45"]},focusIndicatorVertical:{Brovlpu:"ftqa4ok",B486eqv:"f2hkw1w",Bssx7fj:"f1b1k54r",uh7if5:["f4ne723","fqqcjud"],clntm0:"fh7aioi",Dlk2r6:["fqqcjud","f4ne723"],h6p2u:"f1ufm4qn",I6qiy5:["f1qnwcb4","fgrk5zm"],yzno9d:"fi52z01",By0wis0:["fgrk5zm","f1qnwcb4"],B2j2mmj:"ffht0p2",wigs8:"f1p0ul1q",pbfy6t:"f1c901ms",B0v4ure:"f1alokd7",Byrf0fs:0,Bsiemmq:0,Bwckmig:0,skfxo0:0,Iidy0u:0,B98u21t:0,Bvwlmkc:0,jo1ztg:0,Ba1iezr:0,Blmvk6g:0,B24cy0v:0,Bil7v7r:0,Br3gin4:0,nr063g:0,ghq09:0,Bbgo44z:0,Bseh09z:"fmj8fco",az1dzo:0,Ba3ybja:0,B6352mv:0,vppk2z:0,Biaj6j7:"f1iwowo3",B2pnrqr:"f1pffoy2",B29w5g4:["fm5xmfm","femsgmt"],Bhhzhcn:"fs6b7xr",Bec0n69:["femsgmt","fm5xmfm"]}},{d:[".f10pi13n{position:relative;}",".fwk3njj{display:inline-grid;}",".f1sdsnyy{touch-action:none;}",".f122n59{align-items:center;}",".f1oiokrs{justify-items:center;}",".f1agqo6f{--fui-Slider__thumb--size:16px;}",".f1mmvox9{--fui-Slider__inner-thumb--radius:5px;}",".f1i7ztpd{--fui-Slider__rail--size:2px;}",".f1pha7fy{min-height:24px;}",".f1a78h9h{--fui-Slider__thumb--size:20px;}",".fh1udnr{--fui-Slider__inner-thumb--radius:6px;}",".fuok0yf{--fui-Slider__rail--size:4px;}",".f1nxs5xn{min-height:32px;}",".fyvtabn{min-width:120px;}",".fgfd48t{grid-template-rows:1fr var(--fui-Slider__thumb--size) 1fr;}",".f4t5rw1{grid-template-columns:1fr calc(100% - var(--fui-Slider__thumb--size)) 1fr;}",".f1pzv1zu{min-height:120px;}",".fktlcaf{grid-template-rows:1fr calc(100% - var(--fui-Slider__thumb--size)) 1fr;}",".fiadc6h{grid-template-columns:1fr var(--fui-Slider__thumb--size) 1fr;}",".f4l8x3l{--fui-Slider__rail--color:var(--colorNeutralStrokeAccessible);}",".f671q34{--fui-Slider__progress--color:var(--colorCompoundBrandBackground);}",".fvfzmw5{--fui-Slider__thumb--color:var(--colorCompoundBrandBackground);}",".foojseg{--fui-Slider__thumb--color:var(--colorNeutralForegroundDisabled);}",".f1lgdqhv{--fui-Slider__rail--color:var(--colorNeutralBackgroundDisabled);}",".f1veetlj{--fui-Slider__progress--color:var(--colorNeutralForegroundDisabled);}",".f1b1k54r[data-fui-focus-within]:focus-within{border-top-color:transparent;}",".f4ne723[data-fui-focus-within]:focus-within{border-right-color:transparent;}",".fqqcjud[data-fui-focus-within]:focus-within{border-left-color:transparent;}",".fh7aioi[data-fui-focus-within]:focus-within{border-bottom-color:transparent;}",'.ffht0p2[data-fui-focus-within]:focus-within::after{content:"";}',".f1p0ul1q[data-fui-focus-within]:focus-within::after{position:absolute;}",".f1c901ms[data-fui-focus-within]:focus-within::after{pointer-events:none;}",".f1alokd7[data-fui-focus-within]:focus-within::after{z-index:1;}",[".fmj8fco[data-fui-focus-within]:focus-within::after{border:2px solid var(--colorStrokeFocus2);}",{p:-2}],[".f1iwowo3[data-fui-focus-within]:focus-within::after{border-radius:var(--borderRadiusMedium);}",{p:-1}],".f1pffoy2[data-fui-focus-within]:focus-within::after{top:calc(0px - 2px - -2px);}",".f1dfga45[data-fui-focus-within]:focus-within::after{right:calc(0px - 2px - -4px);}",".f63jj3o[data-fui-focus-within]:focus-within::after{left:calc(0px - 2px - -4px);}",".fs6b7xr[data-fui-focus-within]:focus-within::after{bottom:calc(0px - 2px - -2px);}",[".fmj8fco[data-fui-focus-within]:focus-within::after{border:2px solid var(--colorStrokeFocus2);}",{p:-2}],[".f1iwowo3[data-fui-focus-within]:focus-within::after{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fm5xmfm[data-fui-focus-within]:focus-within::after{right:calc(0px - 2px - 4px);}",".femsgmt[data-fui-focus-within]:focus-within::after{left:calc(0px - 2px - 4px);}"],h:[".faw1t00:hover{--fui-Slider__thumb--color:var(--colorCompoundBrandBackgroundHover);}",".fxdgx5:hover{--fui-Slider__progress--color:var(--colorCompoundBrandBackgroundHover);}"],a:[".fii04fa:active{--fui-Slider__thumb--color:var(--colorCompoundBrandBackgroundPressed);}",".f36hzz8:active{--fui-Slider__progress--color:var(--colorCompoundBrandBackgroundPressed);}"],m:[["@media (forced-colors: active){.fdjsfay{--fui-Slider__rail--color:CanvasText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1fen33d{--fui-Slider__thumb--color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1c6b0w1{--fui-Slider__progress--color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1rq9b4z:hover{--fui-Slider__thumb--color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f4xxiul:hover{--fui-Slider__progress--color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fn4acdm{--fui-Slider__rail--color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f4s8dx0{--fui-Slider__thumb--color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1wil5xy{--fui-Slider__progress--color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ufm4qn[data-fui-focus-within]:focus-within::after{border-top-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1qnwcb4[data-fui-focus-within]:focus-within::after{border-right-color:Highlight;}.fgrk5zm[data-fui-focus-within]:focus-within::after{border-left-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fi52z01[data-fui-focus-within]:focus-within::after{border-bottom-color:Highlight;}}",{m:"(forced-colors: active)"}]],f:[".ftqa4ok:focus{outline-style:none;}"],i:[".f2hkw1w:focus-visible{outline-style:none;}"]}),xo=Se({rail:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1kijzfu",Bkecrkj:"f1aehjj5",Ijaq50:"faunodf",nk6f5a:"f88nxoq",Br312pm:"fd46tj4",Bw0ie65:"f1e2fz10",qhf8xq:"f10pi13n",Bvjb7m6:"fdgv6k0",Bcmaq0h:"fizngqt",Bpd4iqm:"fpvhumw",oeaueh:"f1yog68k",Bw0xxkn:"f13sgyd8",Ftih45:"fzhtfnv",Brfgrao:"f1j7ml58",Bbn5juq:"fx36ao7",Bses4cn:"fddlh2i"},horizontal:{a9b677:"fly5x3f",Bqenvij:"f1cy86ho",Fbdkly:["f1heqfse","fkh49vu"],mdwyqc:["fkh49vu","f1heqfse"],Baz25je:"f16tdq4e"},vertical:{a9b677:"fqxfnkd",Bqenvij:"f1l02sjl",Ccq8qp:"f1rik0od",Bciustq:"f14xwovp",lawp4y:"fdehrcx"}},{d:[[".f1kijzfu{border-radius:var(--borderRadiusXLarge);}",{p:-1}],".f1aehjj5{pointer-events:none;}",".faunodf{grid-row-start:2;}",".f88nxoq{grid-row-end:2;}",".fd46tj4{grid-column-start:2;}",".f1e2fz10{grid-column-end:2;}",".f10pi13n{position:relative;}",".fdgv6k0{forced-color-adjust:none;}",`.fizngqt{background-image:linear-gradient(
      var(--fui-Slider--direction),
      var(--fui-Slider__progress--color) 0%,
      var(--fui-Slider__progress--color) var(--fui-Slider--progress),
      var(--fui-Slider__rail--color) var(--fui-Slider--progress)
    );}`,".fpvhumw{outline-width:1px;}",".f1yog68k{outline-style:solid;}",".f13sgyd8{outline-color:var(--colorTransparentStroke);}",".fzhtfnv::before{content:'';}",".f1j7ml58::before{position:absolute;}",`.fx36ao7::before{background-image:repeating-linear-gradient(
        var(--fui-Slider--direction),
        #0000 0%,
        #0000 calc(var(--fui-Slider--steps-percent) - 1px),
        var(--colorNeutralBackground1) calc(var(--fui-Slider--steps-percent) - 1px),
        var(--colorNeutralBackground1) var(--fui-Slider--steps-percent)
      );}`,".fly5x3f{width:100%;}",".f1cy86ho{height:var(--fui-Slider__rail--size);}",".f1heqfse::before{left:-1px;}",".fkh49vu::before{right:-1px;}",".f16tdq4e::before{height:var(--fui-Slider__rail--size);}",".fqxfnkd{width:var(--fui-Slider__rail--size);}",".f1l02sjl{height:100%;}",".f1rik0od::before{width:var(--fui-Slider__rail--size);}",".f14xwovp::before{top:-1px;}",".fdehrcx::before{bottom:-1px;}"],m:[[`@media (forced-colors: active){.fddlh2i::before{background-image:repeating-linear-gradient(
          var(--fui-Slider--direction),
          #0000 0%,
          #0000 calc(var(--fui-Slider--steps-percent) - 1px),
          HighlightText calc(var(--fui-Slider--steps-percent) - 1px),
          HighlightText var(--fui-Slider--steps-percent)
        );}}`,{m:"(forced-colors: active)"}]]}),vo=Se({thumb:{B2lzsem:"ftx3jue",Ijaq50:"faunodf",nk6f5a:"f88nxoq",Br312pm:"fd46tj4",Bw0ie65:"f1e2fz10",qhf8xq:"f1euv43f",a9b677:"f174ca62",Bqenvij:"f1yfdkfd",Bkecrkj:"f1aehjj5",oeaueh:"f1s6fcnf",Bvjb7m6:"fdgv6k0",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f44lkw9",E5pizo:"fof7hq0",De3pzq:"foksa45",Brfgrao:"f1j7ml58",Bciustq:"f14u7mkt",Fbdkly:["f5zrw40","f1ks5ppg"],lawp4y:"fto0uou",mdwyqc:["f1ks5ppg","f5zrw40"],r59vdv:0,Budzafs:0,ck0cow:0,n07z76:0,Gng75u:"fielpny",Bcvre1j:"fyl8oag",Ftih45:"fzhtfnv",Bcgcnre:0,Bqjgrrk:0,qa3bma:0,y0oebl:0,Biqmznv:0,Bm6vgfq:0,Bbv0w2i:0,uvfttm:0,eqrjj:0,Bk5zm6e:0,m598lv:0,B4f6apu:0,ydt019:0,Bq4z7u6:0,Bdkvgpv:0,B0qfbqy:0,kj8mxx:"f1fsco4d"},disabled:{Bcgcnre:0,Bqjgrrk:0,qa3bma:0,y0oebl:0,Biqmznv:0,Bm6vgfq:0,Bbv0w2i:0,uvfttm:0,eqrjj:0,Bk5zm6e:0,m598lv:0,B4f6apu:0,ydt019:0,Bq4z7u6:0,Bdkvgpv:0,B0qfbqy:0,kj8mxx:"f1pv9hn4"},horizontal:{Bz10aip:["f13gfj74","f1nfknbn"],oyh7mz:["foa2ioz","fjmilum"]},vertical:{Bz10aip:"f5cv5a3",B5kzvoi:"f1k2fpdo"}},{d:[".ftx3jue{--fui-Slider__thumb--position:clamp(var(--fui-Slider__inner-thumb--radius), var(--fui-Slider--progress), calc(100% - var(--fui-Slider__inner-thumb--radius)));}",".faunodf{grid-row-start:2;}",".f88nxoq{grid-row-end:2;}",".fd46tj4{grid-column-start:2;}",".f1e2fz10{grid-column-end:2;}",".f1euv43f{position:absolute;}",".f174ca62{width:var(--fui-Slider__thumb--size);}",".f1yfdkfd{height:var(--fui-Slider__thumb--size);}",".f1aehjj5{pointer-events:none;}",".f1s6fcnf{outline-style:none;}",".fdgv6k0{forced-color-adjust:none;}",[".f44lkw9{border-radius:var(--borderRadiusCircular);}",{p:-1}],".fof7hq0{box-shadow:0 0 0 calc(var(--fui-Slider__thumb--size) * .2) var(--colorNeutralBackground1) inset;}",".foksa45{background-color:var(--fui-Slider__thumb--color);}",".f1j7ml58::before{position:absolute;}",".f14u7mkt::before{top:0px;}",".f5zrw40::before{left:0px;}",".f1ks5ppg::before{right:0px;}",".fto0uou::before{bottom:0px;}",[".fielpny::before{border-radius:var(--borderRadiusCircular);}",{p:-1}],".fyl8oag::before{box-sizing:border-box;}",".fzhtfnv::before{content:'';}",[".f1fsco4d::before{border:calc(var(--fui-Slider__thumb--size) * .05) solid var(--colorNeutralStroke1);}",{p:-2}],[".f1pv9hn4::before{border:calc(var(--fui-Slider__thumb--size) * .05) solid var(--colorNeutralForegroundDisabled);}",{p:-2}],".f13gfj74{transform:translateX(-50%);}",".f1nfknbn{transform:translateX(50%);}",".foa2ioz{left:var(--fui-Slider__thumb--position);}",".fjmilum{right:var(--fui-Slider__thumb--position);}",".f5cv5a3{transform:translateY(50%);}",".f1k2fpdo{bottom:var(--fui-Slider__thumb--position);}"]}),jo=Se({input:{Bceei9c:"f1k6fduh",abs64n:"fk73vx1",Ijaq50:"f16hsg94",nk6f5a:"f1nzqi2z",Br312pm:"fwpfdsa",Bw0ie65:"fuur7zz",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1mk8lai",jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:"f1s184ao"},disabled:{Bceei9c:"f158kwzp"},horizontal:{Bqenvij:"f1yfdkfd",a9b677:"fly5x3f"},vertical:{Bqenvij:"f1l02sjl",a9b677:"f174ca62",wtfg9d:"f135tqni",By3ymbm:["f114o3fk","f1o9w1zd"],B1e78rk:"f1jr0wcp"}},{d:[".f1k6fduh{cursor:pointer;}",".fk73vx1{opacity:0;}",".f16hsg94{grid-row-start:1;}",".f1nzqi2z{grid-row-end:-1;}",".fwpfdsa{grid-column-start:1;}",".fuur7zz{grid-column-end:-1;}",[".f1mk8lai{padding:0;}",{p:-1}],[".f1s184ao{margin:0;}",{p:-1}],".f158kwzp{cursor:default;}",".f1yfdkfd{height:var(--fui-Slider__thumb--size);}",".fly5x3f{width:100%;}",".f1l02sjl{height:100%;}",".f174ca62{width:var(--fui-Slider__thumb--size);}"],t:["@supports (writing-mode: sideways-lr){.f135tqni{writing-mode:vertical-lr;}}","@supports (writing-mode: sideways-lr){.f114o3fk{direction:rtl;}.f1o9w1zd{direction:ltr;}}","@supports not (writing-mode: sideways-lr){.f1jr0wcp{-webkit-appearance:slider-vertical;}}"]}),bo=t=>{"use no memo";const o=po(),s=xo(),r=vo(),l=jo(),p=t.vertical;return t.root.className=ze(Fe.root,o.root,p?o.focusIndicatorVertical:o.focusIndicatorHorizontal,o[t.size],p?o.vertical:o.horizontal,t.disabled?o.disabled:o.enabled,t.root.className),t.rail.className=ze(Fe.rail,s.rail,p?s.vertical:s.horizontal,t.rail.className),t.thumb.className=ze(Fe.thumb,r.thumb,p?r.vertical:r.horizontal,t.disabled&&r.disabled,t.thumb.className),t.input.className=ze(Fe.input,l.input,p?l.vertical:l.horizontal,t.disabled&&l.disabled,t.input.className),t},{sliderStepsPercentVar:So,sliderProgressVar:_o,sliderDirectionVar:wo}=go,yo=(t,o,s)=>s===o?0:(t-o)/(s-o)*100,ko=(t,o)=>{"use no memo";const{min:s=0,max:r=100,step:l}=o,{dir:p}=Mt(),[j,_]=St({state:o.value,defaultState:o.defaultValue,initialState:0}),c=ut(j,s,r),h=yo(c,s,r),S=t.input.onChange,g=o.onChange,n=_t(W=>{const L=Number(W.target.value);_(ut(L,s,r)),S&&S!==g?S(W):g&&g(W,{value:L})}),x=l&&l>0?`${l*100/(r-s)}%`:void 0,w={[wo]:t.vertical?"0deg":p==="ltr"?"90deg":"270deg",[_o]:`${h}%`,...x!==void 0&&{[So]:x}};return t.root.style={...w,...t.root.style},t.input.value=c,t.input.onChange=n,t},Eo=(t,o)=>{t=Ft(t,{supportsLabelFor:!0});const s=Lt({props:t,primarySlotTagName:"input",excludedPropNames:["onChange","size"]}),{disabled:r,vertical:l,size:p="medium",root:j,input:_,rail:c,thumb:h}=t,S={disabled:r,size:p,vertical:l,components:{input:"input",rail:"div",root:"div",thumb:"div"},root:Me(j,{defaultProps:s.root,elementType:"div"}),input:Me(_,{defaultProps:{id:It("slider-",t.id),ref:o,...s.primary,type:"range",orient:l?"vertical":void 0},elementType:"input"}),rail:Me(c,{elementType:"div"}),thumb:Me(h,{elementType:"div"})};return S.root.ref=Wt(S.root.ref,$t()),ko(S,t),S},No=t=>Vt(t.root,{children:[Ye(t.input,{}),Ye(t.rail,{}),Ye(t.thumb,{})]}),Tt=u.forwardRef((t,o)=>{const s=Eo(t,o);return bo(s),wt("useSliderStyles_unstable")(s),No(s)});Tt.displayName="Slider";const Bo=he({section:{display:"flex",flexDirection:"column",rowGap:i.spacingHorizontalS},header:{display:"flex",alignItems:"center",justifyContent:"space-between"},tableWrap:{border:`1px solid ${i.colorNeutralStroke2}`,borderRadius:i.borderRadiusLarge,overflow:"auto",maxHeight:"40vh",width:"100%",boxShadow:i.shadow2},row:{display:"flex",columnGap:i.spacingHorizontalS},rightAlign:{textAlign:"right"},flex1:{flex:1},orderWidth:{width:"10ch"},actionsRow:{display:"flex",gap:i.spacingHorizontalS,justifyContent:"flex-end"}});function Co({all:t,run:o,refresh:s}){const r={name:"",start_time:"",end_time:"",ordering:0},[l,p]=u.useState([]),[j,_]=u.useState(null),[c,h]=u.useState(!1),[S,g]=u.useState(r),n=je();function x(){p(t("SELECT id,name,start_time,end_time,ordering FROM segment ORDER BY ordering"))}u.useEffect(x,[]);function w(){_(null),g({...r,ordering:l.length?l[l.length-1].ordering+1:1}),h(!0)}function W(d){_(d),g({name:d.name,start_time:d.start_time,end_time:d.end_time,ordering:d.ordering}),h(!0)}function L(){if(!S.name.trim()){n.showAlert("Name is required","Validation Error");return}if(!/^\d{2}:\d{2}$/.test(S.start_time)||!/^\d{2}:\d{2}$/.test(S.end_time)){n.showAlert("Times must be HH:MM","Validation Error");return}j?o("UPDATE segment SET name=?, start_time=?, end_time=?, ordering=? WHERE id=?",[S.name,S.start_time,S.end_time,S.ordering,j.id]):o("INSERT INTO segment (name,start_time,end_time,ordering) VALUES (?,?,?,?)",[S.name,S.start_time,S.end_time,S.ordering]),x(),s(),h(!1),_(null),g(r)}function y(){h(!1),_(null),g(r)}async function A(d){await n.showConfirm("Are you sure you want to delete this segment?","Delete Segment")&&(o("DELETE FROM segment WHERE id=?",[d]),x(),s())}const R=Bo();return e.jsxs("div",{className:R.section,children:[e.jsxs("div",{className:R.header,children:[e.jsx(X,{weight:"semibold",children:"Segments"}),e.jsx(T,{appearance:"primary",onClick:w,children:"Add Segment"})]}),e.jsx("div",{className:R.tableWrap,children:e.jsxs(fe,{"aria-label":"Segments table",children:[e.jsx(ue,{children:e.jsxs(K,{children:[e.jsx(C,{children:"Name"}),e.jsx(C,{children:"Start"}),e.jsx(C,{children:"End"}),e.jsx(C,{children:"Order"}),e.jsx(C,{})]})}),e.jsx(me,{children:l.map(d=>e.jsxs(K,{children:[e.jsx(D,{children:d.name}),e.jsx(D,{children:d.start_time}),e.jsx(D,{children:d.end_time}),e.jsx(D,{children:d.ordering}),e.jsx(D,{className:d.rightAlign,children:e.jsxs("div",{className:d.actionsRow,children:[e.jsx(T,{size:"small",onClick:()=>W(d),children:"Edit"}),e.jsx(T,{size:"small",appearance:"secondary",onClick:()=>A(d.id),children:"Delete"})]})})]},d.id))})]})}),c&&e.jsxs("div",{className:R.section,children:[e.jsx(ee,{label:"Name",required:!0,children:e.jsx(Z,{value:S.name,onChange:(d,f)=>g({...S,name:f.value})})}),e.jsxs("div",{className:R.row,children:[e.jsx(ee,{label:"Start (HH:MM)",className:R.flex1,children:e.jsx(Z,{value:S.start_time,onChange:(d,f)=>g({...S,start_time:f.value})})}),e.jsx(ee,{label:"End (HH:MM)",className:R.flex1,children:e.jsx(Z,{value:S.end_time,onChange:(d,f)=>g({...S,end_time:f.value})})}),e.jsx(ee,{label:"Order",className:R.orderWidth,children:e.jsx(Z,{type:"number",value:String(S.ordering),onChange:(d,f)=>g({...S,ordering:Number(f.value||0)})})})]}),e.jsxs("div",{className:R.row,children:[e.jsx(T,{appearance:"primary",onClick:L,children:"Save"}),e.jsx(T,{onClick:y,children:"Cancel"})]})]}),n.alertState&&e.jsx(Be,{open:!0,title:n.alertState.title,message:n.alertState.message,onClose:n.closeAlert}),n.confirmState&&e.jsx(pe,{open:!0,title:n.confirmState.options.title,message:n.confirmState.options.message,confirmText:n.confirmState.options.confirmText,cancelText:n.confirmState.options.cancelText,onConfirm:()=>n.handleConfirm(!0),onCancel:()=>n.handleConfirm(!1)})]})}const To=he({root:{border:`1px solid ${i.colorNeutralStroke2}`,borderRadius:i.borderRadiusLarge,padding:i.spacingHorizontalM,backgroundColor:i.colorNeutralBackground1},header:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:i.spacingVerticalM},headerTitle:{display:"flex",alignItems:"center",gap:i.spacingHorizontalS},tableWrap:{border:`1px solid ${i.colorNeutralStroke2}`,borderRadius:i.borderRadiusMedium,overflow:"auto",maxHeight:"40vh"},formGrid:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:i.spacingHorizontalM,marginBottom:i.spacingVerticalM},formField:{display:"flex",flexDirection:"column",gap:i.spacingVerticalXS},fullWidth:{gridColumn:"span 2"},actions:{display:"flex",gap:i.spacingHorizontalS},emptyState:{padding:i.spacingVerticalL,textAlign:"center",color:i.colorNeutralForeground3},eventBadge:{marginLeft:i.spacingHorizontalS}}),ht=t=>t?new Date(t+"T00:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"}):"",gt=t=>{if(!t)return"";const[o,s]=t.split(":").map(Number),r=o>=12?"PM":"AM";return`${o%12||12}:${s.toString().padStart(2,"0")} ${r}`};function zo({all:t,run:o,refresh:s}){const r=To(),l=je(),[p,j]=u.useState(!1),[_,c]=u.useState(null),[h,S]=u.useState(""),[g,n]=u.useState(""),[x,w]=u.useState("08:00"),[W,L]=u.useState("09:00"),[y,A]=u.useState(null),[R,d]=u.useState(null),[f,N]=u.useState(""),z=u.useMemo(()=>t(`
      SELECT de.*, g.name as group_name, r.name as role_name
      FROM department_event de
      LEFT JOIN grp g ON g.id = de.group_id
      LEFT JOIN role r ON r.id = de.role_id
      ORDER BY de.date DESC, de.start_time ASC
    `),[t]),v=u.useMemo(()=>t("SELECT id, name FROM grp ORDER BY name"),[t]),H=u.useMemo(()=>t("SELECT id, name, group_id FROM role ORDER BY name"),[t]),O=u.useMemo(()=>y?H.filter(b=>b.group_id===y):[],[H,y]),Y=()=>{S(""),n(""),w("08:00"),L("09:00"),A(null),d(null),N(""),c(null)},k=()=>{Y(),j(!0)},q=b=>{c(b),S(b.title),n(b.date),w(b.start_time),L(b.end_time),A(b.group_id),d(b.role_id),N(b.description||""),j(!0)},Q=()=>{if(!h.trim()||!g||!x||!W){l.showAlert("Please fill in all required fields (Title, Date, Start Time, End Time).","Missing Fields");return}if(x>=W){l.showAlert("End time must be after start time.","Invalid Time Range");return}if(_)o("UPDATE department_event SET title=?, date=?, start_time=?, end_time=?, group_id=?, role_id=?, description=? WHERE id=?",[h.trim(),g,x,W,y,R,f.trim()||null,_.id]);else{o("INSERT INTO department_event (title, date, start_time, end_time, group_id, role_id, description) VALUES (?,?,?,?,?,?,?)",[h.trim(),g,x,W,y,R,f.trim()||null]);const b=t("SELECT id FROM department_event WHERE date=? AND title=? ORDER BY id DESC LIMIT 1",[g,h.trim()]);if(b.length>0){b[0].id;const P=t("SELECT id FROM person WHERE active=1");for(const E of P)t("SELECT id FROM assignment WHERE date=? AND person_id=? AND segment=?",[g,E.id,h.trim()]).length===0&&o("INSERT INTO assignment (date, person_id, role_id, segment) VALUES (?,?,?,?)",[g,E.id,R,h.trim()])}}s(),j(!1),Y()},G=async b=>{await l.showConfirm(`Delete "${b.title}" on ${ht(b.date)}? This will also remove all crew assignments for this event.`,"Delete Event")&&(o("DELETE FROM assignment WHERE date=? AND segment=?",[b.date,b.title]),o("DELETE FROM department_event WHERE id=?",[b.id]),s())};return u.useEffect(()=>{R&&y&&(H.find(P=>P.id===R&&P.group_id===y)||d(null))},[y,R,H]),e.jsxs("div",{className:r.root,children:[e.jsxs("div",{className:r.header,children:[e.jsxs("div",{className:r.headerTitle,children:[e.jsx(yt,{}),e.jsx(X,{weight:"semibold",children:"Department Events"}),e.jsx(kt,{appearance:"filled",color:"informative",className:r.eventBadge,children:z.length})]}),e.jsx(T,{appearance:"primary",icon:e.jsx(Pt,{}),onClick:k,children:"Add Event"})]}),z.length===0?e.jsx("div",{className:r.emptyState,children:e.jsx(X,{children:'No department events scheduled. Click "Add Event" to create one.'})}):e.jsx("div",{className:r.tableWrap,children:e.jsxs(fe,{size:"small",children:[e.jsx(ue,{children:e.jsxs(K,{children:[e.jsx(C,{children:"Title"}),e.jsx(C,{children:"Date"}),e.jsx(C,{children:"Time"}),e.jsx(C,{children:"Group"}),e.jsx(C,{children:"Role"}),e.jsx(C,{children:"Actions"})]})}),e.jsx(me,{children:z.map(b=>e.jsxs(K,{children:[e.jsx(D,{children:b.title}),e.jsx(D,{children:ht(b.date)}),e.jsxs(D,{children:[gt(b.start_time)," - ",gt(b.end_time)]}),e.jsx(D,{children:b.group_name||"—"}),e.jsx(D,{children:b.role_name||b.group_name||"—"}),e.jsx(D,{children:e.jsxs("div",{className:r.actions,children:[e.jsx(T,{appearance:"subtle",icon:e.jsx(Ut,{}),size:"small",onClick:()=>q(b)}),e.jsx(T,{appearance:"subtle",icon:e.jsx(Et,{}),size:"small",onClick:()=>G(b)})]})})]},b.id))})]})}),e.jsx(_e,{open:p,onOpenChange:(b,P)=>{P.open||(j(!1),Y())},children:e.jsx(we,{children:e.jsxs(ye,{children:[e.jsx(ke,{children:_?"Edit Event":"Add Department Event"}),e.jsxs(Ee,{children:[e.jsxs("div",{className:r.formGrid,children:[e.jsxs("div",{className:`${r.formField} ${r.fullWidth}`,children:[e.jsx(ve,{required:!0,children:"Event Title"}),e.jsx(Z,{value:h,onChange:(b,P)=>S(P.value),placeholder:"e.g., Department Meeting, Safety Training"})]}),e.jsxs("div",{className:r.formField,children:[e.jsx(ve,{required:!0,children:"Date"}),e.jsx(Z,{type:"date",value:g,onChange:(b,P)=>n(P.value)})]}),e.jsx("div",{className:r.formField}),e.jsxs("div",{className:r.formField,children:[e.jsx(ve,{required:!0,children:"Start Time"}),e.jsx(Z,{type:"time",value:x,onChange:(b,P)=>w(P.value)})]}),e.jsxs("div",{className:r.formField,children:[e.jsx(ve,{required:!0,children:"End Time"}),e.jsx(Z,{type:"time",value:W,onChange:(b,P)=>L(P.value)})]}),e.jsxs("div",{className:r.formField,children:[e.jsx(ve,{children:"Group (for export)"}),e.jsx(st,{options:[{value:"",label:"— Select Group —"},...v.map(b=>({value:String(b.id),label:b.name}))],value:y?String(y):null,onChange:b=>A(b?Number(b):null),placeholder:"Select group..."})]}),e.jsxs("div",{className:r.formField,children:[e.jsx(ve,{children:"Role (optional)"}),e.jsx(st,{options:[{value:"",label:`— Default: ${y?v.find(b=>b.id===y)?.name||"Group Name":"Select Group First"} —`},...O.map(b=>({value:String(b.id),label:b.name}))],value:R?String(R):null,onChange:b=>d(b?Number(b):null),placeholder:"Select role...",disabled:!y})]}),e.jsxs("div",{className:`${r.formField} ${r.fullWidth}`,children:[e.jsx(ve,{children:"Description"}),e.jsx(Nt,{value:f,onChange:(b,P)=>N(P.value),placeholder:"Optional notes about this event...",rows:2})]})]}),e.jsx(X,{size:200,style:{color:i.colorNeutralForeground3},children:"When created, all active crew members will be automatically assigned to this event. Regular shifts will be adjusted to accommodate the event time."})]}),e.jsxs(Ne,{children:[e.jsx(T,{appearance:"secondary",onClick:()=>{j(!1),Y()},children:"Cancel"}),e.jsx(T,{appearance:"primary",onClick:Q,children:_?"Save Changes":"Create Event"})]})]})})}),l.confirmState&&e.jsx(pe,{open:!0,title:l.confirmState.options.title||"Confirm",message:l.confirmState.options.message,onConfirm:()=>l.handleConfirm(!0),onCancel:()=>l.handleConfirm(!1)}),l.alertState&&e.jsx(_e,{open:!0,onOpenChange:()=>l.closeAlert(),children:e.jsx(we,{children:e.jsxs(ye,{children:[e.jsx(ke,{children:l.alertState.title}),e.jsx(Ee,{children:l.alertState.message}),e.jsx(Ne,{children:e.jsx(T,{appearance:"primary",onClick:l.closeAlert,children:"OK"})})]})})})]})}const pt=[{value:"condition.start",label:"Condition Start"},{value:"condition.end",label:"Condition End"},{value:"target.start",label:"Target Start"},{value:"target.end",label:"Target End"}],Te=t=>{const[o,s]=t.split(":").map(Number);return o*60+s},xt=t=>String(t).padStart(2,"0"),Le=t=>`${xt(Math.floor(t/60))}:${xt(t%60)}`,Do=he({section:{display:"flex",flexDirection:"column",rowGap:i.spacingHorizontalS},header:{display:"flex",alignItems:"center",justifyContent:"space-between"},tableWrap:{border:`1px solid ${i.colorNeutralStroke2}`,borderRadius:i.borderRadiusLarge,overflow:"auto",maxHeight:"40vh",width:"100%",boxShadow:i.shadow2},row:{display:"flex",columnGap:i.spacingHorizontalS},flex1:{flex:1},actionsRow:{display:"flex",gap:i.spacingHorizontalS,justifyContent:"flex-end"},number:{width:"12ch"},previewWrap:{display:"flex",flexDirection:"column",rowGap:i.spacingVerticalXS,marginTop:i.spacingVerticalS},timeline:{position:"relative",height:8,background:i.colorNeutralBackground5,borderRadius:i.borderRadiusSmall},condBar:{position:"absolute",top:0,bottom:0,background:i.colorNeutralForeground3,opacity:.3},targetBar:{position:"absolute",top:0,bottom:0,background:i.colorNeutralForeground2,opacity:.4},adjustedBar:{position:"absolute",top:0,bottom:0,background:i.colorBrandBackground},conditionSection:{display:"flex",flexDirection:"column",gap:i.spacingVerticalS,padding:i.spacingVerticalM,border:`1px solid ${i.colorNeutralStroke2}`,borderRadius:i.borderRadiusMedium,backgroundColor:i.colorNeutralBackground1},conditionRow:{display:"flex",alignItems:"flex-end",gap:i.spacingHorizontalS},conditionHeader:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:i.spacingVerticalXS},logicToggle:{display:"flex",alignItems:"center",gap:i.spacingHorizontalXS},conditionDescription:{padding:i.spacingVerticalS,backgroundColor:i.colorNeutralBackground3,borderRadius:i.borderRadiusMedium,fontSize:i.fontSizeBase300},conditionBadge:{display:"inline-flex",alignItems:"center",gap:i.spacingHorizontalXXS}});function Ro({all:t,run:o,refresh:s,segments:r,db:l}){const p={condition_segment:"",condition_role_id:null,target_segment:"",target_field:"start",baseline:"condition.start",offset_minutes:0,logic_operator:"AND"},[j,_]=u.useState([]),[c,h]=u.useState(null),[S,g]=u.useState(!1),[n,x]=u.useState(p),[w,W]=u.useState([{condition_segment:"",condition_role_id:null}]),[L,y]=u.useState("AND"),[A,R]=u.useState([]),[d,f]=u.useState(new Map),N=je(),z=u.useMemo(()=>{const a=pt.find(m=>m.value===n.baseline);return a?a.label:""},[n.baseline]),v=r.find(a=>a.name===w[0]?.condition_segment),H=r.find(a=>a.name===n.target_segment);let O=null;if(H){const a=Te(H.start_time),m=Te(H.end_time),B=w.map(F=>{const U=r.find(oe=>oe.name===F.condition_segment);return U?{start:Te(U.start_time),end:Te(U.end_time),name:U.name}:null}).filter(Boolean);if(v&&B.length>0){const F=Te(v.start_time),U=Te(v.end_time);let oe=null;switch(n.baseline){case"condition.start":oe=F;break;case"condition.end":oe=U;break;case"target.start":oe=a;break;case"target.end":oe=m;break}if(oe!=null){const Ce=oe+n.offset_minutes;let Re=a,qe=m;n.target_field==="start"?Re=Ce:qe=Ce,O={conditionSegments:B,targetStart:a,targetEnd:m,newStart:Re,newEnd:qe}}}}function Y(){let a;try{a=t("SELECT id,condition_segment,condition_role_id,target_segment,target_field,baseline,offset_minutes,COALESCE(logic_operator,'AND') as logic_operator FROM segment_adjustment")}catch{console.log("Querying segment_adjustment without logic_operator (pre-migration)"),a=t("SELECT id,condition_segment,condition_role_id,target_segment,target_field,baseline,offset_minutes FROM segment_adjustment"),a=a.map(F=>({...F,logic_operator:"AND"}))}_(a),R(t("SELECT id,name FROM role ORDER BY name"));const m=new Map;for(const B of a)try{const F=Gt(l,B.id);F.length>0&&m.set(B.id,F)}catch(F){console.error("Error loading conditions for adjustment",B.id,F)}f(m)}u.useEffect(Y,[t,l]);function k(){h(null),x(p),W([{condition_segment:"",condition_role_id:null}]),y("AND"),g(!0)}function q(a){h(a),x({condition_segment:a.condition_segment||"",condition_role_id:a.condition_role_id??null,target_segment:a.target_segment,target_field:a.target_field,baseline:a.baseline,offset_minutes:a.offset_minutes,logic_operator:a.logic_operator||"AND"});const m=d.get(a.id);m&&m.length>0?W(m.map(B=>({condition_segment:B.condition_segment,condition_role_id:B.condition_role_id}))):W([{condition_segment:a.condition_segment||"",condition_role_id:a.condition_role_id??null}]),y(a.logic_operator||"AND"),g(!0)}function Q(){const a=w.filter(U=>U.condition_segment);if(a.length===0){N.showAlert("At least one condition is required","Validation Error");return}if(!n.target_segment){N.showAlert("Target segment is required","Validation Error");return}const m=a[0],B=[m.condition_segment,m.condition_role_id,n.target_segment,n.target_field,n.baseline,n.offset_minutes,L];let F;if(c){try{o("UPDATE segment_adjustment SET condition_segment=?, condition_role_id=?, target_segment=?, target_field=?, baseline=?, offset_minutes=?, logic_operator=? WHERE id=?",[...B,c.id])}catch{console.log("Updating segment_adjustment without logic_operator (pre-migration)"),o("UPDATE segment_adjustment SET condition_segment=?, condition_role_id=?, target_segment=?, target_field=?, baseline=?, offset_minutes=? WHERE id=?",[B[0],B[1],B[2],B[3],B[4],B[5],c.id])}F=c.id;try{o("DELETE FROM segment_adjustment_condition WHERE adjustment_id=?",[F])}catch{console.log("segment_adjustment_condition table does not exist (pre-migration)")}}else{try{o("INSERT INTO segment_adjustment (condition_segment,condition_role_id,target_segment,target_field,baseline,offset_minutes,logic_operator) VALUES (?,?,?,?,?,?,?)",B)}catch{console.log("Inserting into segment_adjustment without logic_operator (pre-migration)"),o("INSERT INTO segment_adjustment (condition_segment,condition_role_id,target_segment,target_field,baseline,offset_minutes) VALUES (?,?,?,?,?,?)",[B[0],B[1],B[2],B[3],B[4],B[5]])}F=t("SELECT last_insert_rowid() as id")[0]?.id}try{for(const U of a)o("INSERT INTO segment_adjustment_condition (adjustment_id, condition_segment, condition_role_id) VALUES (?, ?, ?)",[F,U.condition_segment,U.condition_role_id])}catch{console.log("segment_adjustment_condition table does not exist (pre-migration)")}Y(),s(),G()}function G(){g(!1),h(null),x(p),W([{condition_segment:"",condition_role_id:null}]),y("AND")}async function b(a){if(await N.showConfirm("Are you sure you want to delete this adjustment?","Delete Adjustment")){o("DELETE FROM segment_adjustment WHERE id=?",[a]);try{o("DELETE FROM segment_adjustment_condition WHERE adjustment_id=?",[a])}catch{console.log("segment_adjustment_condition table does not exist (pre-migration)")}Y(),s()}}function P(){W([...w,{condition_segment:"",condition_role_id:null}])}function E(a){w.length>1&&W(w.filter((m,B)=>B!==a))}function V(a,m,B){const F=[...w];F[a]={...F[a],[m]:B},W(F)}function I(a,m){if(!m||m.length===0){const U=a.condition_role_id?` (${A.find(oe=>oe.id===a.condition_role_id)?.name||""})`:"";return`When ${a.condition_segment}${U} is scheduled`}if(m.length===1){const U=m[0].condition_role_id?` (${A.find(oe=>oe.id===m[0].condition_role_id)?.name||""})`:"";return`When ${m[0].condition_segment}${U} is scheduled`}const B=a.logic_operator||"AND",F=m.map(U=>{const oe=U.condition_role_id?` (${A.find(Ce=>Ce.id===U.condition_role_id)?.name||""})`:"";return`${U.condition_segment}${oe}`});return B==="AND"?`When ${F.join(" AND ")} are scheduled`:`When ${F.join(" OR ")} is scheduled`}const M=Do();return e.jsxs("div",{className:M.section,children:[e.jsxs("div",{className:M.header,children:[e.jsx(X,{weight:"semibold",children:"Segment Adjustments"}),e.jsx(T,{appearance:"primary",onClick:k,children:"Add Adjustment"})]}),e.jsx("div",{className:M.tableWrap,children:e.jsxs(fe,{"aria-label":"Segment adjustments",children:[e.jsx(ue,{children:e.jsxs(K,{children:[e.jsx(C,{children:"Conditions"}),e.jsx(C,{children:"Target"}),e.jsx(C,{children:"Field"}),e.jsx(C,{children:"Baseline"}),e.jsx(C,{children:"Offset (min)"}),e.jsx(C,{})]})}),e.jsx(me,{children:j.map(a=>{const m=d.get(a.id)||[],B=I(a,m),F=a.logic_operator||"AND";return e.jsxs(K,{children:[e.jsx(D,{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:i.spacingHorizontalXS},children:[B,m.length>1&&e.jsx(kt,{appearance:"outline",color:F==="AND"?"informative":"warning",children:F})]})}),e.jsx(D,{children:a.target_segment}),e.jsx(D,{children:a.target_field}),e.jsx(D,{children:a.baseline}),e.jsx(D,{children:a.offset_minutes}),e.jsx(D,{children:e.jsxs("div",{className:M.actionsRow,children:[e.jsx(T,{size:"small",onClick:()=>q(a),children:"Edit"}),e.jsx(T,{size:"small",appearance:"secondary",onClick:()=>b(a.id),children:"Delete"})]})})]},a.id)})})]})}),S&&e.jsxs("div",{className:M.section,children:[e.jsxs("div",{className:M.conditionSection,children:[e.jsxs("div",{className:M.conditionHeader,children:[e.jsx(X,{weight:"semibold",children:"Conditions"}),w.length>1&&e.jsxs("div",{className:M.logicToggle,children:[e.jsx(X,{size:200,children:"Logic:"}),e.jsx(Ct,{checked:L==="AND",onClick:()=>y(L==="AND"?"OR":"AND"),appearance:"outline",size:"small",children:L})]})]}),w.map((a,m)=>e.jsxs("div",{className:M.conditionRow,children:[e.jsx(ee,{label:`Segment ${m+1}`,className:M.flex1,children:e.jsx(le,{selectedOptions:[a.condition_segment],value:a.condition_segment,onOptionSelect:(B,F)=>V(m,"condition_segment",F.optionValue||""),children:r.map(B=>e.jsx(J,{value:B.name,text:B.name,children:B.name},B.name))})}),e.jsx(ee,{label:`Role ${m+1}`,className:M.flex1,children:e.jsxs(le,{selectedOptions:[a.condition_role_id==null?"":String(a.condition_role_id)],value:a.condition_role_id==null?"Any":A.find(B=>B.id===a.condition_role_id)?.name||"",onOptionSelect:(B,F)=>V(m,"condition_role_id",F.optionValue?Number(F.optionValue):null),children:[e.jsx(J,{value:"",text:"Any",children:"Any"}),A.map(B=>e.jsx(J,{value:String(B.id),text:B.name,children:B.name},B.id))]})}),w.length>1&&e.jsx(T,{icon:e.jsx(Et,{}),appearance:"subtle",onClick:()=>E(m),"aria-label":"Remove condition"})]},m)),e.jsx(T,{appearance:"subtle",onClick:P,size:"small",children:"+ Add Condition"}),w.some(a=>a.condition_segment)&&e.jsx("div",{className:M.conditionDescription,children:e.jsxs(X,{size:200,children:[w.filter(a=>a.condition_segment).length===1?`When ${w.find(a=>a.condition_segment)?.condition_segment}${w.find(a=>a.condition_segment)?.condition_role_id?` (${A.find(a=>a.id===w.find(m=>m.condition_segment)?.condition_role_id)?.name})`:""} is scheduled`:w.filter(a=>a.condition_segment).length>1?`When ${w.filter(a=>a.condition_segment).map(a=>{const m=a.condition_role_id?` (${A.find(B=>B.id===a.condition_role_id)?.name})`:"";return`${a.condition_segment}${m}`}).join(` ${L} `)} ${L==="AND"?"are":"is"} scheduled`:"Select condition segments",n.target_segment&&`, adjust ${n.target_segment}'s ${n.target_field} time`]})})]}),e.jsxs("div",{className:M.row,children:[e.jsx(ee,{label:"Target Segment",className:M.flex1,children:e.jsx(le,{selectedOptions:[n.target_segment],value:n.target_segment,onOptionSelect:(a,m)=>x({...n,target_segment:m.optionValue||""}),children:r.map(a=>e.jsx(J,{value:a.name,text:a.name,children:a.name},a.name))})}),e.jsx(ee,{label:"Field",className:M.flex1,children:e.jsxs(le,{selectedOptions:[n.target_field],value:n.target_field,onOptionSelect:(a,m)=>x({...n,target_field:m.optionValue}),children:[e.jsx(J,{value:"start",text:"start",children:"start"}),e.jsx(J,{value:"end",text:"end",children:"end"})]})})]}),e.jsxs("div",{className:M.row,children:[e.jsx(ee,{label:"Baseline",className:M.flex1,children:e.jsx(le,{selectedOptions:[n.baseline],value:z,onOptionSelect:(a,m)=>x({...n,baseline:m.optionValue}),children:pt.map(a=>e.jsx(J,{value:a.value,text:a.label,children:a.label},a.value))})}),e.jsx(ee,{label:"Offset Minutes",className:M.number,children:e.jsx(Z,{type:"number",value:String(n.offset_minutes),onChange:(a,m)=>x({...n,offset_minutes:Number(m.value||0)})})})]}),O&&e.jsxs("div",{className:M.previewWrap,children:[e.jsx(X,{size:200,children:"Preview"}),e.jsxs("div",{className:M.timeline,children:[O.conditionSegments.map((a,m)=>e.jsx("div",{className:M.condBar,style:{left:`${a.start/(24*60)*100}%`,width:`${(a.end-a.start)/(24*60)*100}%`,opacity:.3-m*.05}},m)),e.jsx("div",{className:M.targetBar,style:{left:`${O.targetStart/(24*60)*100}%`,width:`${(O.targetEnd-O.targetStart)/(24*60)*100}%`}}),e.jsx("div",{className:M.adjustedBar,style:{left:`${O.newStart/(24*60)*100}%`,width:`${(O.newEnd-O.newStart)/(24*60)*100}%`}})]}),e.jsxs(X,{size:200,children:[n.target_segment,": ",Le(O.targetStart),"-",Le(O.targetEnd)," → ",Le(O.newStart),"-",Le(O.newEnd)]})]}),e.jsxs("div",{className:M.row,children:[e.jsx(T,{appearance:"primary",onClick:Q,children:"Save"}),e.jsx(T,{onClick:G,children:"Cancel"})]})]}),N.alertState&&e.jsx(Be,{open:!0,title:N.alertState.title,message:N.alertState.message,onClose:N.closeAlert}),N.confirmState&&e.jsx(pe,{open:!0,title:N.confirmState.options.title,message:N.confirmState.options.message,confirmText:N.confirmState.options.confirmText,cancelText:N.confirmState.options.cancelText,onConfirm:()=>N.handleConfirm(!0),onCancel:()=>N.handleConfirm(!1)})]})}const qo=he({root:{display:"flex",flexDirection:"column",rowGap:i.spacingVerticalM},headerBar:{display:"flex",justifyContent:"space-between",alignItems:"center"},tableWrap:{borderRadius:i.borderRadiusMedium,boxShadow:i.shadow4,overflow:"auto",maxHeight:"40vh",width:"100%"},formSection:{display:"flex",flexDirection:"column",rowGap:i.spacingVerticalS},actionRow:{display:"flex",columnGap:i.spacingHorizontalS}});function Ao({all:t,run:o,refresh:s}){const r=qo(),l={name:"",theme:"",custom_color:""},[p,j]=u.useState([]),[_,c]=u.useState(null),[h,S]=u.useState(!1),[g,n]=u.useState(l),x=je();function w(){j(t("SELECT id,name,theme,custom_color FROM grp ORDER BY name"))}u.useEffect(w,[]);function W(){c(null),n(l),S(!0)}function L(d){c(d),n({name:d.name,theme:d.theme||"",custom_color:d.custom_color||""}),S(!0)}function y(){if(!g.name.trim()){x.showAlert("Name is required","Validation Error");return}_?o("UPDATE grp SET name=?, theme=?, custom_color=? WHERE id=?",[g.name,g.theme||null,g.custom_color||null,_.id]):o("INSERT INTO grp (name, theme, custom_color) VALUES (?,?,?)",[g.name,g.theme||null,g.custom_color||null]),w(),s(),S(!1),c(null),n(l)}function A(){S(!1),c(null),n(l)}async function R(d){await x.showConfirm("Are you sure you want to delete this group? This will also delete all associated roles.","Delete Group")&&(o("DELETE FROM role WHERE group_id=?",[d]),o("DELETE FROM grp WHERE id=?",[d]),w(),s())}return e.jsxs("div",{className:r.root,children:[e.jsx("div",{className:r.headerBar,children:e.jsxs(lt,{"aria-label":"Group actions",size:"small",style:{width:"100%"},children:[e.jsx(X,{weight:"semibold",children:"Groups"}),e.jsx("div",{style:{flex:1}}),e.jsx(Je,{appearance:"primary",onClick:W,children:"Add Group"})]})}),e.jsx("div",{className:r.tableWrap,children:e.jsxs(fe,{"aria-label":"Groups table",children:[e.jsx(ue,{children:e.jsxs(K,{children:[e.jsx(C,{children:"Name"}),e.jsx(C,{children:"Theme"}),e.jsx(C,{children:"Color"}),e.jsx(C,{})]})}),e.jsx(me,{children:p.map(d=>e.jsxs(K,{children:[e.jsx(D,{children:d.name}),e.jsx(D,{children:d.theme?e.jsx("span",{style:{display:"inline-flex",alignItems:"center",padding:"2px 8px",backgroundColor:be(d.theme)?.color||i.colorNeutralBackground3,color:be(d.theme)?Ze(be(d.theme).color):void 0,borderRadius:i.borderRadiusSmall,fontSize:i.fontSizeBase200},children:be(d.theme)?.label||d.theme}):""}),e.jsx(D,{children:d.custom_color||""}),e.jsx(D,{style:{textAlign:"right"},children:e.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[e.jsx(T,{size:"small",onClick:()=>L(d),children:"Edit"}),e.jsx(T,{size:"small",appearance:"secondary",onClick:()=>R(d.id),children:"Delete"})]})})]},d.id))})]})}),h&&e.jsxs("div",{className:r.formSection,children:[e.jsx(ee,{label:"Name",required:!0,children:e.jsx(Z,{value:g.name,onChange:(d,f)=>n({...g,name:f.value})})}),e.jsx(ee,{label:"Theme",children:e.jsxs(le,{selectedOptions:g.theme?[g.theme]:[],value:be(g.theme)?.label||g.theme||"",onOptionSelect:(d,f)=>{const N=f.optionValue??"";n({...g,theme:N})},placeholder:"(None)",style:be(g.theme)?{backgroundColor:be(g.theme).color,color:Ze(be(g.theme).color)}:void 0,children:[e.jsx(J,{value:"",text:"(None)",children:"(None)"}),Xt.map(d=>e.jsx(J,{value:d.value,text:d.label,children:e.jsx("span",{style:{display:"inline-flex",alignItems:"center",width:"100%",padding:"4px 8px",margin:"-4px -8px",backgroundColor:d.color,color:Ze(d.color),borderRadius:i.borderRadiusSmall},children:d.label})},d.value))]})}),e.jsx(ee,{label:"Custom Color",children:e.jsx(Z,{value:g.custom_color,onChange:(d,f)=>n({...g,custom_color:f.value})})}),e.jsx("div",{className:r.actionRow,children:e.jsxs(lt,{"aria-label":"Form actions",size:"small",children:[e.jsx(Je,{appearance:"primary",onClick:y,children:"Save"}),e.jsx(Yt,{}),e.jsx(Je,{onClick:A,children:"Cancel"})]})})]}),x.alertState&&e.jsx(Be,{open:!0,title:x.alertState.title,message:x.alertState.message,onClose:x.closeAlert}),x.confirmState&&e.jsx(pe,{open:!0,title:x.confirmState.options.title,message:x.confirmState.options.message,confirmText:x.confirmState.options.confirmText,cancelText:x.confirmState.options.cancelText,onConfirm:()=>x.handleConfirm(!0),onCancel:()=>x.handleConfirm(!1)})]})}const Oo=he({section:{display:"flex",flexDirection:"column",rowGap:i.spacingHorizontalS},header:{display:"flex",alignItems:"center",justifyContent:"space-between"},tableWrap:{border:`1px solid ${i.colorNeutralStroke2}`,borderRadius:i.borderRadiusLarge,overflow:"auto",maxHeight:"40vh",width:"100%",boxShadow:i.shadow2},row:{display:"flex",columnGap:i.spacingHorizontalS,flexWrap:"wrap"},rightAlign:{textAlign:"right"},actionsRow:{display:"flex",gap:i.spacingHorizontalS,justifyContent:"flex-end"}});function Ho({all:t,run:o,refresh:s,segments:r}){const[l,p]=u.useState([]),[j,_]=u.useState([]),[c,h]=u.useState(null),[S,g]=u.useState(!1),n=je();function x(){p(t("SELECT r.id,r.code,r.name,r.group_id,r.segments,g.name as group_name FROM role r JOIN grp g ON g.id=r.group_id ORDER BY g.name,r.name").map(f=>({...f,segs:new Set(JSON.parse(f.segments))}))),_(t("SELECT id,name FROM grp ORDER BY name"))}u.useEffect(x,[]);function w(){h({id:null,code:"",name:"",group_id:j[0]?.id||0,segs:new Set}),g(!0)}function W(f){h({...f,segs:new Set(f.segs)}),g(!0)}function L(f){if(!c)return;const N=new Set(c.segs);N.has(f)?N.delete(f):N.add(f),h({...c,segs:N})}function y(){if(!c)return;const f=Array.from(c.segs);if(!c.code.trim()||!c.name.trim()){n.showAlert("Code and name are required","Validation Error");return}if(!f.length){n.showAlert("Select at least one segment","Validation Error");return}c.id?o("UPDATE role SET code=?, name=?, group_id=?, segments=? WHERE id=?",[c.code,c.name,c.group_id,JSON.stringify(f),c.id]):o("INSERT INTO role (code,name,group_id,segments) VALUES (?,?,?,?)",[c.code,c.name,c.group_id,JSON.stringify(f)]),x(),s(),g(!1),h(null)}function A(){g(!1),h(null)}async function R(f){await n.showConfirm("Are you sure you want to delete this role?","Delete Role")&&(o("DELETE FROM role WHERE id=?",[f]),x(),s())}const d=Oo();return e.jsxs("div",{className:d.section,children:[e.jsxs("div",{className:d.header,children:[e.jsx(X,{weight:"semibold",children:"Roles"}),e.jsx(T,{appearance:"primary",onClick:w,children:"Add Role"})]}),e.jsx("div",{className:d.tableWrap,children:e.jsxs(fe,{"aria-label":"Roles table",children:[e.jsx(ue,{children:e.jsxs(K,{children:[e.jsx(C,{children:"Code"}),e.jsx(C,{children:"Name"}),e.jsx(C,{children:"Group"}),e.jsx(C,{children:"Segments"}),e.jsx(C,{})]})}),e.jsx(me,{children:l.map(f=>e.jsxs(K,{children:[e.jsx(D,{children:f.code}),e.jsx(D,{children:f.name}),e.jsx(D,{children:f.group_name}),e.jsx(D,{children:Array.from(f.segs).join(", ")}),e.jsx(D,{className:d.rightAlign,children:e.jsxs("div",{className:d.actionsRow,children:[e.jsx(T,{size:"small",onClick:()=>W(f),children:"Edit"}),e.jsx(T,{size:"small",appearance:"secondary",onClick:()=>R(f.id),children:"Delete"})]})})]},f.id))})]})}),S&&c&&e.jsxs("div",{className:d.section,children:[e.jsx(ee,{label:"Code",required:!0,children:e.jsx(Z,{value:c.code,onChange:(f,N)=>h({...c,code:N.value})})}),e.jsx(ee,{label:"Name",required:!0,children:e.jsx(Z,{value:c.name,onChange:(f,N)=>h({...c,name:N.value})})}),e.jsx(ee,{label:"Group",children:e.jsx(le,{selectedOptions:c.group_id!=null?[String(c.group_id)]:[],value:(()=>{const f=j.find(N=>N.id===c.group_id);return f?f.name:""})(),onOptionSelect:(f,N)=>{const z=Number(N.optionValue??N.optionText);h({...c,group_id:z})},children:j.map(f=>e.jsx(J,{value:String(f.id),text:f.name,children:f.name},f.id))},`role-group-${c?.id??"new"}-${j.map(f=>`${f.id}:${f.name}`).join(",")}-${c.group_id}`)}),e.jsx("div",{className:d.row,children:r.map(f=>e.jsx(Jt,{label:f.name,checked:c.segs.has(f.name),onChange:()=>L(f.name)},f.name))}),e.jsxs("div",{className:d.row,children:[e.jsx(T,{appearance:"primary",onClick:y,children:"Save"}),e.jsx(T,{onClick:A,children:"Cancel"})]})]}),n.alertState&&e.jsx(Be,{open:!0,title:n.alertState.title,message:n.alertState.message,onClose:n.closeAlert}),n.confirmState&&e.jsx(pe,{open:!0,title:n.confirmState.options.title,message:n.confirmState.options.message,confirmText:n.confirmState.options.confirmText,cancelText:n.confirmState.options.cancelText,onConfirm:()=>n.handleConfirm(!0),onCancel:()=>n.handleConfirm(!1)})]})}const Mo=he({section:{display:"flex",flexDirection:"column",rowGap:i.spacingHorizontalS},header:{display:"flex",alignItems:"center",justifyContent:"space-between"},tableWrap:{border:`1px solid ${i.colorNeutralStroke2}`,borderRadius:i.borderRadiusLarge,overflow:"auto",maxHeight:"40vh",width:"100%",boxShadow:i.shadow2},row:{display:"flex",columnGap:i.spacingHorizontalS},rightAlign:{textAlign:"right"},actionsRow:{display:"flex",gap:i.spacingHorizontalS,justifyContent:"flex-end"}});function Fo({all:t,run:o,refresh:s}){const r={group_id:"",code:"",color:"",column_group:""},[l,p]=u.useState([]),[j,_]=u.useState([]),[c,h]=u.useState(null),[S,g]=u.useState(!1),[n,x]=u.useState(r),w=je(),W=n.group_id===""?"":j.find(z=>z.id===Number(n.group_id))?.name||"";function L(){const z=t(`SELECT eg.group_id, g.name as group_name, eg.code, eg.color, eg.column_group
                     FROM export_group eg JOIN grp g ON g.id=eg.group_id ORDER BY g.name`);p(z);const v=new Set(z.map(O=>O.group_id)),H=t("SELECT id,name FROM grp ORDER BY name").filter(O=>!v.has(O.id));_(H)}u.useEffect(L,[]);function y(){h(null),x(r),g(!0)}function A(z){h(z),x({group_id:z.group_id,code:z.code,color:z.color,column_group:z.column_group}),g(!0)}function R(){if(!n.group_id){w.showAlert("Group is required","Validation Error");return}if(!n.code.trim()){w.showAlert("Code is required","Validation Error");return}c?o("UPDATE export_group SET code=?, color=?, column_group=? WHERE group_id=?",[n.code,n.color,n.column_group,c.group_id]):o("INSERT INTO export_group (group_id, code, color, column_group) VALUES (?,?,?,?)",[n.group_id,n.code,n.color,n.column_group]),L(),s(),g(!1),h(null),x(r)}function d(){g(!1),h(null),x(r)}async function f(z){await w.showConfirm("Are you sure you want to delete this export metadata?","Delete Export Metadata")&&(o("DELETE FROM export_group WHERE group_id=?",[z]),L(),s())}const N=Mo();return e.jsxs("div",{className:N.section,children:[e.jsxs("div",{className:N.header,children:[e.jsx(X,{weight:"semibold",children:"Export Groups"}),e.jsx(T,{appearance:"primary",onClick:y,children:"Add Export Group"})]}),e.jsx("div",{className:N.tableWrap,children:e.jsxs(fe,{"aria-label":"Export groups table",children:[e.jsx(ue,{children:e.jsxs(K,{children:[e.jsx(C,{children:"Group"}),e.jsx(C,{children:"Code"}),e.jsx(C,{children:"Color"}),e.jsx(C,{children:"Column Group"}),e.jsx(C,{})]})}),e.jsx(me,{children:l.map(z=>e.jsxs(K,{children:[e.jsx(D,{children:z.group_name}),e.jsx(D,{children:z.code}),e.jsx(D,{children:z.color}),e.jsx(D,{children:z.column_group}),e.jsx(D,{className:N.rightAlign,children:e.jsxs("div",{className:N.actionsRow,children:[e.jsx(T,{size:"small",onClick:()=>A(z),children:"Edit"}),e.jsx(T,{size:"small",appearance:"secondary",onClick:()=>f(z.group_id),children:"Delete"})]})})]},z.group_id))})]})}),S&&e.jsxs("div",{className:N.section,children:[c?e.jsx("div",{children:l.find(z=>z.group_id===c.group_id)?.group_name}):e.jsx(ee,{label:"Group",required:!0,children:e.jsx(le,{placeholder:"Select group…",selectedOptions:n.group_id?[String(n.group_id)]:[],value:W,onOptionSelect:(z,v)=>x({...n,group_id:Number(v.optionValue??v.optionText)}),children:j.map(z=>e.jsx(J,{value:String(z.id),text:z.name,children:z.name},z.id))},`export-group-${j.map(z=>`${z.id}:${z.name}`).join(",")}-${n.group_id}`)}),e.jsx(ee,{label:"Code",required:!0,children:e.jsx(Z,{value:n.code,onChange:(z,v)=>x({...n,code:v.value})})}),e.jsx(ee,{label:"Color",children:e.jsx(Z,{value:n.color,onChange:(z,v)=>x({...n,color:v.value})})}),e.jsx(ee,{label:"Column Group",children:e.jsx(Z,{value:n.column_group,onChange:(z,v)=>x({...n,column_group:v.value})})}),e.jsxs("div",{className:N.row,children:[e.jsx(T,{appearance:"primary",onClick:R,children:"Save"}),e.jsx(T,{onClick:d,children:"Cancel"})]})]}),w.alertState&&e.jsx(Be,{open:!0,title:w.alertState.title,message:w.alertState.message,onClose:w.closeAlert}),w.confirmState&&e.jsx(pe,{open:!0,title:w.confirmState.options.title,message:w.confirmState.options.message,confirmText:w.confirmState.options.confirmText,cancelText:w.confirmState.options.cancelText,onConfirm:()=>w.handleConfirm(!0),onCancel:()=>w.handleConfirm(!1)})]})}const Lo="https://cdn.sheetjs.com/xlsx-0.20.2/package/xlsx.mjs";async function Io(){try{return await import(Lo)}catch{throw new Error("Failed to load XLSX library from CDN. Please check your internet connection and try again. If the problem persists, this may indicate a CDN service issue.")}}function zt(t){const[o,s,r]=String(t).split("/").map(l=>parseInt(String(l).trim(),10));return new Date(r,(o||1)-1,s||1,0,0,0,0)}function Dt(t){const s=String(t).trim().match(/^(\d{1,2})(?::(\d{2}))?\s*(AM|PM)?$/i);if(!s)return{h:0,m:0};let r=parseInt(s[1],10)||0;const l=parseInt(s[2]||"0",10)||0,p=s[3]?.toUpperCase();return p==="AM"&&r===12&&(r=0),p==="PM"&&r!==12&&(r+=12),{h:r,m:l}}function vt(t,o){const s=zt(t),{h:r,m:l}=Dt(o);return new Date(s.getFullYear(),s.getMonth(),s.getDate(),r,l,0,0)}function Wo(t){const o=new Date(Date.UTC(1899,11,30)),s=Math.round(t*24*60*60*1e3);return new Date(o.getTime()+s)}function $o(t){if(t==null||t==="")return null;if(t instanceof Date&&!isNaN(t.getTime()))return t;if(typeof t=="number"&&isFinite(t))return Wo(t);const o=String(t).trim();if(/^\d{4}-\d{2}-\d{2}/.test(o)||/T/.test(o)){const r=new Date(o);return isNaN(r.getTime())?null:r}const s=zt(o);return isNaN(s.getTime())?null:s}function Vo(t){if(t==null||t==="")return null;if(t instanceof Date&&!isNaN(t.getTime()))return{h:t.getHours(),m:t.getMinutes()};if(typeof t=="number"&&isFinite(t)){const s=Math.round(t*24*60),r=Math.floor(s/60),l=s%60;return{h:r,m:l}}return Dt(String(t))}function jt(t,o,s={h:0,m:0}){if(t instanceof Date){const p=t;if(p.getHours()!==0||p.getMinutes()!==0)return p}else if(typeof t=="string"&&/\d:\d|T\d{2}:\d{2}/.test(t)){const p=new Date(t);if(!isNaN(p.getTime()))return p}const r=$o(t);if(!r)return null;const l=Vo(o)??s;return new Date(r.getFullYear(),r.getMonth(),r.getDate(),l.h,l.m,0,0)}function Po(t){const o=String(t??"").trim(),s=o.match(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/i);return(s?s[0]:o).toLowerCase()}function Ie(t){return String(t||"").replace(/^\ufeff/,"").replace(/\s+/g," ").trim().toLowerCase().replace(/[^a-z0-9]+/g,"")}const Uo=he({root:{border:`1px solid ${i.colorNeutralStroke2}`,borderRadius:i.borderRadiusLarge,padding:i.spacingHorizontalM,backgroundColor:i.colorNeutralBackground1},header:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:i.spacingVerticalM},grid:{display:"grid",gridTemplateColumns:"repeat(12, 1fr)",gap:i.spacingHorizontalS,marginBottom:i.spacingVerticalM},col3:{gridColumn:"span 3"},col4:{gridColumn:"span 4"},actions:{display:"flex",gap:i.spacingHorizontalS,alignItems:"center"},status:{color:i.colorNeutralForeground3,fontSize:i.fontSizeBase200},tableWrap:{border:`1px solid ${i.colorNeutralStroke2}`,borderRadius:i.borderRadiusMedium,overflow:"auto",maxHeight:"40vh"}});function Go({all:t,run:o,refresh:s}){const r=Uo(),l=je(),[p,j]=u.useState(""),[_,c]=u.useState(null),h=u.useMemo(()=>t("SELECT id, first_name, last_name, work_email FROM person WHERE active=1 ORDER BY last_name, first_name"),[t]),[S,g]=u.useState(h[0]?.id??null),[n,x]=u.useState(""),[w,W]=u.useState("08:00"),[L,y]=u.useState(""),[A,R]=u.useState("17:00"),[d,f]=u.useState(""),N=u.useMemo(()=>{if(S==null)return"Select person";const k=h.find(q=>q.id===S);return k?`${k.last_name}, ${k.first_name}`:""},[S,h]),z=t("SELECT t.id, t.person_id, t.start_ts, t.end_ts, t.reason, p.first_name, p.last_name, p.work_email FROM timeoff t JOIN person p ON p.id=t.person_id ORDER BY t.start_ts DESC LIMIT 200");async function v(k){try{const q=await Io();let Q;if(/\.csv$/i.test(k.name)||String(k.type).includes("text/csv")){const $=await k.text();Q=q.read($,{type:"string"})}else{const $=await k.arrayBuffer();Q=q.read($,{type:"array",cellDates:!0})}const G=["Member","Work Email","Start Date","Start Time","End Date","End Time","Time Off Reason"],b=$=>{const re=q.utils.sheet_to_json($,{defval:"",raw:!1});if(!re.length)return 0;const ne=Object.keys(re[0]||{}),ae=new Set(ne.map(ce=>Ie(ce)));let te=0;for(const ce of G)ae.has(Ie(ce))&&te++;return te};let P=Q.SheetNames[0],E=-1;for(const $ of Q.SheetNames){const re=b(Q.Sheets[$]);re>E&&(E=re,P=$)}const V=Q.Sheets[P];let I=[];try{const $=q.utils.sheet_to_json(V,{header:1,defval:""});let re=-1,ne=-1;for(let ae=0;ae<$.length;ae++){const te=$[ae]||[],ce=new Set(te.map(ie=>Ie(String(ie))));let de=0;for(const ie of G)ce.has(Ie(ie))&&de++;de>ne&&(ne=de,re=ae)}if(ne>0&&re>=0){const ae=$[re].map(te=>String(te||""));for(let te=re+1;te<$.length;te++){const ce=$[te]||[];if(!ce.some(ie=>String(ie).trim()!==""))continue;const de={};for(let ie=0;ie<ae.length;ie++)de[ae[ie]]=ce[ie]??"";I.push(de)}}}catch{}if(I.length||(I=q.utils.sheet_to_json(V,{defval:"",raw:!1})),!I.length){j("No rows found in the file.");return}const M=new Map;for(const $ of h)M.set(String($.work_email||"").toLowerCase(),$.id);const a=$=>String($||"").replace(/^\ufeff/,"").replace(/\s+/g," ").trim().toLowerCase().replace(/[^a-z0-9]+/g,""),m=($,re)=>{const ne=Object.keys($),ae=new Map;for(const te of ne)ae.set(a(te),te);for(const te of re){const ce=ne.find(ie=>ie.toLowerCase()===String(te).toLowerCase());if(ce)return $[ce];const de=ae.get(a(te));if(de)return $[de]}return""},B=["Work Email","Email","WorkEmail","User email","User Email","UserEmail","Email Address","Email address","UserPrincipalName","UPN","User"],F=["Member","Name","Display Name","DisplayName"],U=["Start Date","Start date","Start","StartDate","Start Local Date","Start Local Time","Start Date Time","StartDateTime"],oe=["Start Time","Start time","StartTime","Start Local Time"],Ce=["End Date","End date","End","EndDate","End Local Date","End Local Time","End Date Time","EndDateTime"],Re=["End Time","End time","EndTime","End Local Time"],qe=["Time Off Reason","Time off reason","Reason","Notes","Comment"],Ve=new Map;for(const $ of h){const re=`${String($.last_name||"").trim().toLowerCase()},${String($.first_name||"").trim().toLowerCase()}`;Ve.has(re)||Ve.set(re,$.id)}let Pe=0,Ue=0,Ge=0,Ae=0,tt=0,ot=0,rt=0;for(const $ of I){let re=Po(m($,B)),ne=M.get(re);if(!ne){const xe=String(m($,F)),[He,De]=xe.split(",");if(He&&De){const Rt=`${He.trim().toLowerCase()},${De.trim().toLowerCase()}`,at=Ve.get(Rt);at&&(ne=at,rt++)}}if(!ne){Ae++,tt++;continue}const ae=m($,U),te=m($,oe),ce=m($,Ce),de=m($,Re),ie=String(m($,qe)),Oe=jt(ae,te,{h:0,m:0});let ge=jt(ce,de,{h:23,m:59});if(ge&&(ge.getHours()===0&&ge.getMinutes()===0||String(de).trim()==="00:00")){const xe=new Date(ge.getFullYear(),ge.getMonth(),ge.getDate(),0,0,0,0);xe.setDate(xe.getDate()-1),xe.setHours(23,59,0,0),ge=xe}if(!Oe||!ge||!(Oe instanceof Date)||isNaN(Oe.getTime())||isNaN(ge.getTime())){Ae++,ot++;continue}const it=Oe.toISOString(),nt=ge.toISOString(),Xe=t("SELECT id, reason FROM timeoff WHERE person_id=? AND start_ts=? AND end_ts=? LIMIT 1",[ne,it,nt]);if(Xe&&Xe[0]){const xe=Xe[0],He=String(xe.reason||""),De=String(ie||"");He!==De?(o("UPDATE timeoff SET reason=? WHERE id=?",[De,xe.id]),Ue++):Ge++}else o("INSERT INTO timeoff (person_id, start_ts, end_ts, reason, source) VALUES (?,?,?,?,?)",[ne,it,nt,ie,"ImportXLSX"]),Pe++}s(),j(`Import complete: added ${Pe}, updated ${Ue}, ignored ${Ge}, skipped ${Ae}.`),c({added:Pe,updated:Ue,ignored:Ge,skipped:Ae,noEmail:tt,badDate:ot,matchedByName:rt})}catch(q){const Q=q?.message||String(q);console.error("Time-off import error:",q),j(`Time-off import failed: ${Q}`)}}function H(){if(!S||!n||!L){j("Please fill person, start and end.");return}const k=vt(n,w||"00:00"),q=vt(L,A||"23:59");if(q<=k){j("End must be after Start.");return}o("INSERT INTO timeoff (person_id, start_ts, end_ts, reason, source) VALUES (?,?,?,?,?)",[S,k.toISOString(),q.toISOString(),d||null,"Manual"]),j("Added time-off entry."),f(""),s()}function O(){const k=["Member","Work Email","Start Date","Start Time","End Date","End Time","Time Off Reason"],q=["Doe, Jane","jane.doe@example.com","7/15/2025","8:00 AM","7/15/2025","5:00 PM","Vacation"],Q=[k.join(","),q.map(E=>`"${String(E).replace(/"/g,'""')}"`).join(",")].join(`\r
`),G=new Blob([Q],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(G),P=document.createElement("a");P.href=b,P.download="timeoff-sample.csv",document.body.appendChild(P),P.click(),setTimeout(()=>{URL.revokeObjectURL(b),P.remove()},0)}async function Y(k){await l.showConfirm("Are you sure you want to delete this time-off entry?","Delete Time Off")&&(o("DELETE FROM timeoff WHERE id=?",[k]),j("Deleted."),s())}return e.jsxs("section",{className:r.root,children:[e.jsxs("div",{className:r.header,children:[e.jsx("h2",{style:{margin:0},children:"Time Off"}),e.jsxs("div",{className:r.actions,children:[e.jsx("input",{id:"toff-file",type:"file",accept:".xlsx,.csv,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,text/csv",style:{display:"none"},onChange:async k=>{const q=k.target.files?.[0];q&&await v(q),k.target.value=""}}),e.jsx(ct,{content:"Import Teams Time-Off XLSX/CSV",relationship:"label",children:e.jsx(T,{onClick:()=>document.getElementById("toff-file")?.click(),children:"Import Time Off"})}),e.jsx(ct,{content:"Download a sample CSV template",relationship:"label",children:e.jsx(T,{appearance:"secondary",onClick:O,children:"Sample CSV"})})]})]}),e.jsxs("div",{className:r.grid,children:[e.jsx("div",{className:r.col3,children:e.jsx(le,{placeholder:"Select person",selectedOptions:S!=null?[String(S)]:[],value:N,onOptionSelect:(k,q)=>{const Q=q.optionValue??q.optionText;g(Q?Number(Q):null)},children:h.map(k=>{const q=`${k.last_name}, ${k.first_name}`;return e.jsx(J,{value:String(k.id),text:q,children:q},k.id)})})}),e.jsx("div",{className:r.col3,children:e.jsx(Z,{type:"date",value:n,onChange:(k,q)=>x(q.value)})}),e.jsx("div",{className:r.col3,children:e.jsx(Z,{type:"time",value:w,onChange:(k,q)=>W(q.value)})}),e.jsx("div",{className:r.col3,children:e.jsx(Z,{type:"date",value:L,onChange:(k,q)=>y(q.value)})}),e.jsx("div",{className:r.col3,children:e.jsx(Z,{type:"time",value:A,onChange:(k,q)=>R(q.value)})}),e.jsx("div",{className:r.col4,children:e.jsx(Nt,{placeholder:"Reason (optional)",value:d,onChange:(k,q)=>f(q.value)})}),e.jsx("div",{className:r.col3,children:e.jsx(T,{appearance:"primary",onClick:H,children:"Add Time Off"})})]}),e.jsx("div",{className:r.status,children:p}),_&&e.jsxs(_e,{open:!0,onOpenChange:(k,q)=>{q.open||c(null)},children:[e.jsx(Zt,{children:e.jsx("span",{})}),e.jsx(we,{children:e.jsxs(ye,{children:[e.jsx(ke,{children:"Import Summary"}),e.jsx(Ee,{children:e.jsxs("div",{style:{lineHeight:1.8},children:[e.jsxs("div",{children:[e.jsx("b",{children:"Added:"})," ",_.added]}),e.jsxs("div",{children:[e.jsx("b",{children:"Updated:"})," ",_.updated]}),e.jsxs("div",{children:[e.jsx("b",{children:"Ignored (duplicates):"})," ",_.ignored]}),e.jsxs("div",{children:[e.jsx("b",{children:"Skipped:"})," ",_.skipped]}),_.skipped>0&&e.jsxs("div",{style:{marginTop:8,color:i.colorNeutralForeground3},children:["Details: no email ",_.noEmail,", bad date/time ",_.badDate,_.matchedByName?`, matched by name ${_.matchedByName}`:"","."]})]})}),e.jsx(Ne,{children:e.jsx(T,{onClick:()=>c(null),children:"Close"})})]})})]}),e.jsx("div",{className:r.tableWrap,children:e.jsxs(fe,{"aria-label":"Time-off table",children:[e.jsx(ue,{children:e.jsxs(K,{children:[e.jsx(C,{children:"Person"}),e.jsx(C,{children:"Work Email"}),e.jsx(C,{children:"Start"}),e.jsx(C,{children:"End"}),e.jsx(C,{children:"Reason"}),e.jsx(C,{children:"Actions"})]})}),e.jsx(me,{children:z.map(k=>e.jsxs(K,{children:[e.jsx(D,{children:`${k.last_name}, ${k.first_name}`}),e.jsx(D,{children:k.work_email}),e.jsx(D,{children:new Date(k.start_ts).toLocaleString()}),e.jsx(D,{children:new Date(k.end_ts).toLocaleString()}),e.jsx(D,{children:k.reason||""}),e.jsx(D,{children:e.jsx(T,{size:"small",appearance:"secondary",onClick:()=>Y(k.id),children:"Delete"})})]},k.id))})]})}),l.confirmState&&e.jsx(pe,{open:!0,title:l.confirmState.options.title,message:l.confirmState.options.message,confirmText:l.confirmState.options.confirmText,cancelText:l.confirmState.options.cancelText,onConfirm:()=>l.handleConfirm(!0),onCancel:()=>l.handleConfirm(!1)})]})}function We(t){return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}function Qe(t){return new Date(`${t}T00:00:00`)}function bt(t){const s=(t.getDay()+6)%7,r=new Date(t);return r.setDate(t.getDate()-s),r}const Xo=he({root:{border:`1px solid ${i.colorNeutralStroke2}`,borderRadius:i.borderRadiusLarge,padding:i.spacingHorizontalM,backgroundColor:i.colorNeutralBackground1},topRow:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:i.spacingHorizontalS,marginBottom:i.spacingVerticalM},personCol:{gridColumn:"span 4"},dateCol:{gridColumn:"span 3"},weekTable:{marginBottom:i.spacingVerticalM},tableWrap:{border:`1px solid ${i.colorNeutralStroke2}`,borderRadius:i.borderRadiusMedium,overflow:"auto",maxHeight:"40vh"}});function Yo({sqlDb:t,all:o,refresh:s}){const r=Xo(),l=je(),p=u.useMemo(()=>o("SELECT id, first_name, last_name FROM person WHERE active=1 ORDER BY last_name, first_name"),[o]),[j,_]=u.useState(p[0]?.id??null),[c,h]=u.useState(We(new Date)),[S,g]=u.useState(["B","B","B","B","B"]),[n,x]=u.useState(["B","B","B","B","B"]),[w,W]=u.useState([null,null,null,null,null]),[L,y]=u.useState(0),[A,R]=u.useState(null),[d,f]=u.useState(null),[N,z]=u.useState(!1),v=u.useMemo(()=>{for(let E=0;E<5;E++){const V=S[E],I=w[E]??n[E];if(V!==I)return!0}return!1},[S,w,n]),H=E=>{v?(R(E),f(null),z(!0)):_(E)},O=E=>{v?(f(E),R(null),z(!0)):h(E)},Y=()=>{A!=null&&_(A),d!=null&&h(d),R(null),f(null),z(!1)},k=()=>{R(null),f(null),z(!1)},q=u.useMemo(()=>{if(j==null)return"";const E=p.find(V=>V.id===j);return E?`${E.first_name} ${E.last_name}`:""},[j,p]),Q=u.useMemo(()=>o(`SELECT o.person_id, o.date, o.avail, p.first_name, p.last_name
         FROM availability_override o JOIN person p ON p.id=o.person_id
         ORDER BY o.date DESC`),[o,L]);u.useEffect(()=>{if(j==null)return;const E=bt(Qe(c)),V=new Date(E);V.setDate(E.getDate()+4);const I=o("SELECT avail_mon, avail_tue, avail_wed, avail_thu, avail_fri FROM person WHERE id=?",[j])[0],M=[I?.avail_mon||"U",I?.avail_tue||"U",I?.avail_wed||"U",I?.avail_thu||"U",I?.avail_fri||"U"],a=o("SELECT date, avail FROM availability_override WHERE person_id=? AND date BETWEEN ? AND ?",[j,We(E),We(V)]),m=[null,null,null,null,null],B=[...M];a.forEach(F=>{const U=Math.floor((Qe(F.date).getTime()-E.getTime())/864e5);U>=0&&U<5&&(m[U]=F.avail,B[U]=F.avail)}),x(M),g(B),W(m)},[j,c,o,L]);function G(E,V,I){if(!t)return;const M=o("SELECT a.id, a.segment FROM assignment a WHERE a.person_id=? AND a.date=?",[E,V]);for(const a of M){let m=!1;I==="U"?m=!0:I==="AM"?a.segment==="PM"&&(m=!0):I==="PM"&&(a.segment==="AM"||a.segment==="Early")&&(m=!0),m&&t.run("DELETE FROM assignment WHERE id=?",[a.id])}}function b(){if(!t||j==null)return;const E=bt(Qe(c));let V=!1;for(let I=0;I<5;I++){const M=S[I],a=n[I],m=w[I];M===a?m!=null&&(V=!0):V=!0}if(!V){l.showAlert("No changes to save. Availability is unchanged from default.","No Changes");return}for(let I=0;I<5;I++){const M=new Date(E);M.setDate(E.getDate()+I);const a=We(M),m=S[I],B=n[I],F=w[I];m===B?F!=null&&dt(t,j,a):(Kt(t,j,a,m),G(j,a,m))}y(I=>I+1),s()}function P(E,V){t&&(dt(t,E,V),y(I=>I+1),s())}return e.jsxs("div",{className:r.root,children:[e.jsxs("div",{className:r.topRow,children:[e.jsx(le,{className:r.personCol,placeholder:"Select person...",selectedOptions:j!=null?[String(j)]:[],value:q,onOptionSelect:(E,V)=>H(Number(V.optionValue)),children:p.map(E=>{const V=`${E.first_name} ${E.last_name}`;return e.jsx(J,{value:String(E.id),text:V,children:V},E.id)})}),e.jsx(Z,{className:r.dateCol,type:"date",value:c,onChange:(E,V)=>O(V.value)})]}),e.jsxs(fe,{size:"small",className:r.weekTable,children:[e.jsx(ue,{children:e.jsxs(K,{children:[e.jsx(C,{children:"Mon"}),e.jsx(C,{children:"Tue"}),e.jsx(C,{children:"Wed"}),e.jsx(C,{children:"Thu"}),e.jsx(C,{children:"Fri"})]})}),e.jsx(me,{children:e.jsx(K,{children:S.map((E,V)=>e.jsx(D,{children:e.jsxs(le,{selectedOptions:[E],value:E==="U"?"Unavailable":E==="AM"?"AM":E==="PM"?"PM":"Both",onOptionSelect:(I,M)=>g(a=>{const m=[...a];return m[V]=M.optionValue,m}),children:[e.jsx(J,{value:"U",text:"Unavailable",children:"Unavailable"}),e.jsx(J,{value:"AM",text:"AM",children:"AM"}),e.jsx(J,{value:"PM",text:"PM",children:"PM"}),e.jsx(J,{value:"B",text:"Both",children:"Both"})]})},V))})})]}),e.jsx(T,{onClick:b,appearance:"primary",className:r.weekTable,children:"Update"}),e.jsx("div",{className:r.tableWrap,children:e.jsxs(fe,{size:"small",children:[e.jsx(ue,{children:e.jsxs(K,{children:[e.jsx(C,{children:"Person"}),e.jsx(C,{children:"Date"}),e.jsx(C,{children:"Avail"}),e.jsx(C,{children:"Actions"})]})}),e.jsx(me,{children:Q.map(E=>e.jsxs(K,{children:[e.jsxs(D,{children:[E.first_name," ",E.last_name]}),e.jsx(D,{children:E.date}),e.jsx(D,{children:E.avail}),e.jsx(D,{children:e.jsx(T,{appearance:"subtle",onClick:()=>P(E.person_id,E.date),children:"Delete"})})]},`${E.person_id}|${E.date}`))})]})}),l.alertState&&e.jsx(Be,{open:!0,title:l.alertState.title,message:l.alertState.message,onClose:l.closeAlert}),N&&e.jsx(pe,{open:!0,title:"Unsaved Changes",message:"You have unsaved changes. Do you want to discard them?",confirmLabel:"Discard",cancelLabel:"Go Back",onConfirm:Y,onCancel:k})]})}const Jo=he({root:{display:"grid",gap:i.spacingVerticalS},row:{display:"flex",gap:i.spacingHorizontalS,alignItems:"center",flexWrap:"wrap"},tableWrap:{overflow:"auto",border:`1px solid ${i.colorNeutralStroke2}`,borderRadius:i.borderRadiusLarge},code:{width:"140px"},name:{minWidth:"240px",flex:1},groupSel:{width:"220px"},actions:{display:"flex",gap:i.spacingHorizontalS},header:{fontWeight:i.fontWeightSemibold}});function Zo({all:t,run:o,refresh:s}){const r=Jo(),l=je(),[p,j]=se.useState([]),[_,c]=se.useState(""),[h,S]=se.useState(""),[g,n]=se.useState([]),[x,w]=se.useState(""),W=se.useMemo(()=>{if(x==="")return"Select group";const v=g.find(H=>H.id===Number(x));return v?v.name:""},[x,g]),L=se.useMemo(()=>_.trim().length>0&&h.trim().length>0&&x!=="",[_,h,x]),y=se.useCallback(()=>{const H=(t(`SELECT s.id, s.code, s.name, s.active, o.ordering, s.group_id, g.name AS group_name
                     FROM skill s
                     LEFT JOIN skill_order o ON o.skill_id=s.id
                     LEFT JOIN grp g ON g.id=s.group_id
                     ORDER BY COALESCE(o.ordering, 9999), s.name`)||[]).map(k=>({id:Number(k.id),code:String(k.code),name:String(k.name),active:Number(k.active??1),ordering:k.ordering??null,group_id:k.group_id??null,group_name:k.group_name??null}));j(H);const Y=(t("SELECT id, name FROM grp ORDER BY name")||[]).map(k=>({id:Number(k.id),name:String(k.name)}));n(Y),Y.length&&x===""&&w(Y[0].id)},[t,x]);se.useEffect(()=>{y()},[y]);function A(){const v=_.trim(),H=h.trim(),O=x===""?null:Number(x);!v||!H||O==null||(o("INSERT INTO skill (code, name, active, group_id) VALUES (?,?,1,?)",[v,H,O]),c(""),S(""),y(),s())}function R(v){o("UPDATE skill SET active=0 WHERE id=?",[v]),y(),s()}function d(v){o("UPDATE skill SET active=1 WHERE id=?",[v]),y(),s()}async function f(v){if(!await l.showConfirm("This will permanently delete this skill. This cannot be undone.","Delete Skill"))return;const O=t("SELECT COUNT(1) AS c FROM person_skill WHERE skill_id=?",[v]);if(Number(O?.[0]?.c??0)>0){l.showAlert("Cannot delete: this skill has ratings. Deactivate instead.","Cannot Delete");return}o("DELETE FROM skill_order WHERE skill_id=?",[v]),o("DELETE FROM skill WHERE id=?",[v]),y(),s()}function N(v,H){const O=H===""?null:Number(H);o("UPDATE skill SET group_id=? WHERE id=?",[O,v]),y(),s()}function z(v,H){const O=p.slice().sort((G,b)=>(G.ordering??9999)-(b.ordering??9999)||G.name.localeCompare(b.name)),Y=O.findIndex(G=>G.id===v),k=Y+H;if(Y<0||k<0||k>=O.length)return;const[q]=O.splice(Y,1);O.splice(k,0,q);const Q=1e6;for(let G=0;G<O.length;G++){const b=O[G];o(`INSERT INTO skill_order (skill_id, ordering) VALUES (?,?)
         ON CONFLICT(skill_id) DO UPDATE SET ordering=excluded.ordering`,[b.id,Q+G])}for(let G=0;G<O.length;G++){const b=O[G];o(`INSERT INTO skill_order (skill_id, ordering) VALUES (?,?)
         ON CONFLICT(skill_id) DO UPDATE SET ordering=excluded.ordering`,[b.id,G+1])}y(),s()}return e.jsxs("div",{className:r.root,children:[e.jsx("div",{className:r.row,children:e.jsx(ve,{className:r.header,children:"Add Skill"})}),e.jsxs("div",{className:r.row,children:[e.jsx(Z,{className:r.code,placeholder:"Code",value:_,onChange:(v,H)=>c(H.value)}),e.jsx(Z,{className:r.name,placeholder:"Name",value:h,onChange:(v,H)=>S(H.value)}),e.jsxs(le,{className:r.groupSel,selectedOptions:x===""?[""]:[String(x)],value:W,onOptionSelect:(v,H)=>{const O=H.optionValue?parseInt(String(H.optionValue)):"";w(O)},children:[e.jsx(J,{value:"",text:"Select group",children:"Select group"}),g.map(v=>e.jsx(J,{value:String(v.id),text:v.name,children:v.name},v.id))]}),e.jsx(T,{appearance:"primary",onClick:A,disabled:!L,children:"Add"})]}),e.jsx("div",{className:r.tableWrap,children:e.jsxs(fe,{size:"small","aria-label":"Skills",children:[e.jsx(ue,{children:e.jsxs(K,{children:[e.jsx(C,{children:"Code"}),e.jsx(C,{children:"Name"}),e.jsx(C,{children:"Group"}),e.jsx(C,{children:"Active"}),e.jsx(C,{children:"Order"}),e.jsx(C,{})]})}),e.jsx(me,{children:p.map(v=>e.jsxs(K,{children:[e.jsx(D,{children:v.code}),e.jsx(D,{children:v.name}),e.jsx(D,{children:e.jsxs(le,{className:r.groupSel,selectedOptions:v.group_id==null?[""]:[String(v.group_id)],value:v.group_id==null?"Unassigned":g.find(H=>H.id===v.group_id)?.name||"",onOptionSelect:(H,O)=>{const Y=O.optionValue?parseInt(String(O.optionValue)):"";N(v.id,Y)},children:[e.jsx(J,{value:"",text:"Unassigned",children:"Unassigned"}),g.map(H=>e.jsx(J,{value:String(H.id),text:H.name,children:H.name},H.id))]})}),e.jsx(D,{children:v.active?"Yes":"No"}),e.jsxs(D,{className:r.actions,children:[e.jsx(T,{size:"small",onClick:()=>z(v.id,-1),children:"Up"}),e.jsx(T,{size:"small",onClick:()=>z(v.id,1),children:"Down"})]}),e.jsxs(D,{children:[v.active?e.jsx(T,{appearance:"subtle",onClick:()=>R(v.id),children:"Deactivate"}):e.jsx(T,{appearance:"subtle",onClick:()=>d(v.id),children:"Activate"}),e.jsx(T,{appearance:"subtle",onClick:()=>f(v.id),children:"Delete"})]})]},v.id))})]})}),l.alertState&&e.jsx(Be,{open:!0,title:l.alertState.title,message:l.alertState.message,onClose:l.closeAlert}),l.confirmState&&e.jsx(pe,{open:!0,title:l.confirmState.options.title,message:l.confirmState.options.message,confirmText:l.confirmState.options.confirmText,cancelText:l.confirmState.options.cancelText,onConfirm:()=>l.handleConfirm(!0),onCancel:()=>l.handleConfirm(!1)})]})}function Ko({open:t,onClose:o,all:s,run:r}){const[l,p]=u.useState("first_monday");u.useEffect(()=>{if(t)try{const c=s("SELECT value FROM meta WHERE key='week_start_mode'");if(c.length>0&&c[0].value){const h=c[0].value;(h==="first_monday"||h==="first_day")&&p(h)}}catch(c){$e.error("Failed to load week_start_mode:",c)}},[t,s]);function j(){try{r(`INSERT INTO meta (key, value) VALUES ('week_start_mode', ?) 
         ON CONFLICT(key) DO UPDATE SET value=excluded.value`,[l])}catch(c){$e.error("Failed to save week_start_mode:",c)}o()}const _=l==="first_monday"?"First full workweek (First Monday)":"Calendar week (First day of month)";return e.jsx(_e,{open:t,onOpenChange:(c,h)=>{h.open||o()},children:e.jsx(we,{children:e.jsxs(ye,{children:[e.jsx(ke,{children:"Week Calculation Settings"}),e.jsx(Ee,{children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[e.jsx(X,{children:"Choose how week numbers are calculated for week-by-week overrides in Monthly Defaults:"}),e.jsxs(le,{selectedOptions:[l],value:_,onOptionSelect:(c,h)=>p(h.optionValue),children:[e.jsx(J,{value:"first_monday",text:"First full workweek (First Monday)",children:"First full workweek (First Monday)"}),e.jsx(J,{value:"first_day",text:"Calendar week (First day of month)",children:"Calendar week (First day of month)"})]}),e.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"8px"},children:l==="first_monday"?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"First Monday mode:"})," Week 1 starts on the first Monday of the month. Days before the first Monday are not assigned a week number and won't receive week-based overrides."]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"First Day mode:"})," Week 1 starts on the 1st of the month, regardless of the day of the week. Each week is a 7-day period starting from day 1, 8, 15, 22, and 29."]})})]})}),e.jsxs(Ne,{children:[e.jsx(T,{appearance:"secondary",onClick:o,children:"Cancel"}),e.jsx(T,{appearance:"primary",onClick:j,children:"Save"})]})]})})})}function Qo({open:t,onClose:o,all:s,run:r,onThresholdChange:l}){const[p,j]=u.useState(50);u.useEffect(()=>{if(t)try{const c=s("SELECT value FROM meta WHERE key='time_off_block_threshold'");if(c.length>0&&c[0].value){const h=parseInt(c[0].value,10);!isNaN(h)&&h>=25&&h<=75&&j(h)}}catch(c){$e.error("Failed to load time_off_block_threshold:",c)}},[t,s]);function _(){try{r(`INSERT INTO meta (key, value) VALUES ('time_off_block_threshold', ?) 
         ON CONFLICT(key) DO UPDATE SET value=excluded.value`,[String(p)]),l&&l(p)}catch(c){$e.error("Failed to save time_off_block_threshold:",c)}o()}return e.jsx(_e,{open:t,onOpenChange:(c,h)=>{h.open||o()},children:e.jsx(we,{children:e.jsxs(ye,{children:[e.jsx(ke,{children:"Time-Off Threshold Settings"}),e.jsx(Ee,{children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsx(X,{children:"Set the percentage of time-off overlap that blocks scheduling a person. If overlap is below this threshold, you'll be prompted for confirmation instead of being blocked."}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[e.jsxs(ve,{htmlFor:"threshold-slider",style:{fontWeight:600},children:["Block Threshold: ",p,"%"]}),e.jsx(Tt,{id:"threshold-slider",min:25,max:75,step:5,value:p,onChange:(c,h)=>j(h.value),style:{width:"100%"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px",color:"#666"},children:[e.jsx("span",{children:"25% (more permissive)"}),e.jsx("span",{children:"75% (more restrictive)"})]})]}),e.jsxs("div",{style:{fontSize:"12px",color:"#666",marginTop:"8px",lineHeight:"1.5"},children:[e.jsx("strong",{children:"How it works:"}),e.jsxs("ul",{style:{margin:"8px 0",paddingLeft:"20px"},children:[e.jsxs("li",{children:[e.jsxs("strong",{children:["Overlap ≥ ",p,"%:"]})," Scheduling is blocked (person won't appear in dropdown)"]}),e.jsxs("li",{children:[e.jsxs("strong",{children:["Overlap < ",p,"%:"]})," Person can be scheduled with a confirmation dialog"]})]}),e.jsx("em",{children:"Default is 50%, meaning someone with less than half their shift off can still be scheduled with confirmation."})]})]})}),e.jsxs(Ne,{children:[e.jsx(T,{appearance:"secondary",onClick:o,children:"Cancel"}),e.jsx(T,{appearance:"primary",onClick:_,children:"Save"})]})]})})})}const er=he({content:{maxHeight:"400px",overflowY:"auto"},emptyState:{textAlign:"center",padding:i.spacingVerticalXXL,color:i.colorNeutralForeground3},timestamp:{fontFamily:"monospace",fontSize:i.fontSizeBase200},size:{fontSize:i.fontSizeBase200,color:i.colorNeutralForeground3},currentBadge:{backgroundColor:i.colorBrandBackground,color:i.colorNeutralForegroundOnBrand,padding:`${i.spacingVerticalXXS} ${i.spacingHorizontalS}`,borderRadius:i.borderRadiusMedium,fontSize:i.fontSizeBase100,marginLeft:i.spacingHorizontalS},actions:{display:"flex",gap:i.spacingHorizontalXS},lineageRow:{display:"flex",alignItems:"center",gap:i.spacingHorizontalXS,marginTop:i.spacingVerticalXXS},lineageLabel:{fontSize:i.fontSizeBase100,color:i.colorNeutralForeground3},lineageLink:{fontSize:i.fontSizeBase100,color:i.colorBrandForeground1,cursor:"pointer","&:hover":{textDecoration:"underline"}}});function et(t){return t?new Date(t).toLocaleString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Unknown"}function tr({open:t,onClose:o,dirHandle:s,currentFilename:r,onRestore:l,onMerge:p,SQL:j}){const _=er(),[c,h]=u.useState([]),[S,g]=u.useState(!0),[n,x]=u.useState(null);u.useEffect(()=>{t&&s&&j&&w()},[t,s,j]);async function w(){if(!(!s||!j)){g(!0);try{const y=[];for await(const A of s.values())if(A.kind==="file"&&A.name.startsWith("schedule-")&&A.name.endsWith(".db"))try{const R=await A.getFile(),d=await R.arrayBuffer(),f=new j.Database(new Uint8Array(d)),N=z=>{try{return f.exec(`SELECT value FROM meta WHERE key='${z}'`)[0]?.values[0]?.[0]||null}catch{return null}};y.push({filename:A.name,savedAt:N("saved_at")||"",savedBy:N("saved_by")||"Unknown",sessionStartedAt:N("session_started_at")||"",sizeBytes:R.size,derivedFrom:N("derived_from")||null}),f.close()}catch(R){console.warn(`[VersionHistory] Failed to read ${A.name}:`,R)}y.sort((A,R)=>R.savedAt.localeCompare(A.savedAt)),h(y)}catch(y){console.error("[VersionHistory] Failed to load files:",y),h([])}g(!1)}}function W(y){x(y)}function L(){n&&(l(n.filename),x(null),o())}return e.jsxs(e.Fragment,{children:[e.jsx(_e,{open:t,onOpenChange:(y,A)=>!A.open&&o(),children:e.jsx(we,{style:{maxWidth:"700px"},children:e.jsxs(ye,{children:[e.jsx(ke,{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:i.spacingHorizontalS},children:[e.jsx(Bt,{}),"Version History"]})}),e.jsx(Ee,{className:_.content,children:S?e.jsx("div",{className:_.emptyState,children:e.jsx(Qt,{size:"medium"})}):c.length===0?e.jsxs("div",{className:_.emptyState,children:[e.jsx(X,{children:"No saved versions found."}),e.jsx("br",{}),e.jsx(X,{size:200,children:"Each save creates a new timestamped file in the folder."})]}):e.jsxs(fe,{size:"small",children:[e.jsx(ue,{children:e.jsxs(K,{children:[e.jsx(C,{children:"Saved"}),e.jsx(C,{children:"User"}),e.jsx(C,{children:"Lineage"}),e.jsx(C,{})]})}),e.jsx(me,{children:c.map(y=>{const A=y.derivedFrom?c.find(d=>d.filename===y.derivedFrom):null,R=A?`${et(A.savedAt)} (${A.savedBy})`:y.derivedFrom?"Previous version":null;return e.jsxs(K,{children:[e.jsxs(D,{children:[e.jsx(X,{className:_.timestamp,children:et(y.savedAt)}),y.filename===r&&e.jsx("span",{className:_.currentBadge,children:"Current"})]}),e.jsx(D,{children:e.jsx(X,{size:200,children:y.savedBy})}),e.jsx(D,{children:R?e.jsxs("div",{className:_.lineageRow,children:[e.jsx(eo,{}),e.jsx(X,{className:_.lineageLabel,children:R})]}):e.jsx(X,{className:_.lineageLabel,children:"Origin"})}),e.jsx(D,{children:y.filename!==r&&e.jsxs("div",{className:_.actions,children:[e.jsx(T,{size:"small",appearance:"subtle",icon:e.jsx(to,{}),onClick:()=>W(y),children:"Restore"}),e.jsx(T,{size:"small",appearance:"subtle",icon:e.jsx(oo,{}),onClick:()=>p(y.filename),children:"Merge"})]})})]},y.filename)})})]})}),e.jsx(Ne,{children:e.jsx(T,{appearance:"secondary",onClick:o,children:"Close"})})]})})}),n&&e.jsx(pe,{open:!0,title:"Restore Version?",message:`This will load the version saved by ${n.savedBy} at ${et(n.savedAt)}.

Your current unsaved changes will be lost.

Are you sure?`,confirmText:"Restore",cancelText:"Cancel",onConfirm:L,onCancel:()=>x(null)})]})}const or=he({root:{padding:i.spacingHorizontalXL,display:"flex",flexDirection:"column",rowGap:i.spacingVerticalXXL},section:{display:"flex",flexDirection:"column",rowGap:i.spacingVerticalL},sectionHeader:{display:"flex",alignItems:"center",gap:i.spacingHorizontalS,marginBottom:i.spacingVerticalM},sectionTitle:{fontSize:i.fontSizeBase400,fontWeight:i.fontWeightSemibold,color:i.colorNeutralForeground1},card:{padding:i.spacingHorizontalL},buttonRow:{display:"flex",flexDirection:"column",gap:i.spacingVerticalS}});function nr({sqlDb:t,all:o,run:s,refresh:r,segments:l,groups:p,onTimeOffThresholdChange:j,dirHandle:_,currentFilename:c,onRestoreVersion:h,onMergeVersion:S,SQL:g}){const n=or(),[x,w]=se.useState(!1),[W,L]=se.useState(!1),[y,A]=se.useState(!1),[R,d]=se.useState(!1),[f,N]=se.useState(!1);return e.jsxs("div",{className:n.root,children:[e.jsxs("div",{className:n.section,children:[e.jsxs("div",{className:n.sectionHeader,children:[e.jsx(ro,{}),e.jsx(X,{className:n.sectionTitle,children:"Settings"})]}),e.jsx(ft,{className:n.card,children:e.jsxs("div",{className:n.buttonRow,children:[e.jsx(T,{appearance:"outline",onClick:()=>L(!0),children:"Auto-Fill Priority"}),e.jsx(T,{appearance:"outline",onClick:()=>A(!0),children:"Week Calculation Settings"}),e.jsx(T,{appearance:"outline",onClick:()=>d(!0),children:"Time-Off Threshold Settings"}),e.jsx(T,{appearance:"outline",icon:e.jsx(Bt,{}),onClick:()=>N(!0),children:"Version History"})]})})]}),e.jsx(Ke,{}),e.jsxs("div",{className:n.section,children:[e.jsxs("div",{className:n.sectionHeader,children:[e.jsx(io,{}),e.jsx(X,{className:n.sectionTitle,children:"Availability"})]}),e.jsx(ft,{className:n.card,children:e.jsx("div",{className:n.buttonRow,children:e.jsx(T,{appearance:"outline",onClick:()=>w(!0),children:"Availability Overrides"})})}),e.jsx(Go,{all:o,run:s,refresh:r})]}),e.jsx(Ke,{}),e.jsxs("div",{className:n.section,children:[e.jsxs("div",{className:n.sectionHeader,children:[e.jsx(yt,{}),e.jsx(X,{className:n.sectionTitle,children:"Department Events"})]}),e.jsx(zo,{all:o,run:s,refresh:r})]}),e.jsx(Ke,{}),e.jsxs("div",{className:n.section,children:[e.jsxs("div",{className:n.sectionHeader,children:[e.jsx(no,{}),e.jsx(X,{className:n.sectionTitle,children:"Data Configuration"})]}),e.jsx(Co,{all:o,run:s,refresh:r}),e.jsx(Ro,{all:o,run:s,refresh:r,segments:l,db:t}),e.jsx(Ao,{all:o,run:s,refresh:r}),e.jsx(Ho,{all:o,run:s,refresh:r,segments:l}),e.jsx(Fo,{all:o,run:s,refresh:r}),e.jsxs("div",{children:[e.jsx(X,{weight:"semibold",style:{marginBottom:i.spacingVerticalS,display:"block"},children:"Skills Catalog"}),e.jsx(Zo,{all:o,run:s,refresh:r})]})]}),x&&e.jsx(_e,{open:!0,onOpenChange:(z,v)=>{v.open||w(!1)},children:e.jsx(we,{"aria-describedby":void 0,children:e.jsxs(ye,{children:[e.jsx(ke,{children:"Availability Overrides"}),e.jsx(Ee,{children:e.jsx(Yo,{sqlDb:t,all:o,refresh:r})}),e.jsx(Ne,{children:e.jsx(T,{appearance:"primary",onClick:()=>w(!1),children:"Close"})})]})})}),W&&e.jsx(ao,{open:W,onClose:()=>L(!1),all:o,run:s,groups:p}),y&&e.jsx(Ko,{open:y,onClose:()=>A(!1),all:o,run:s}),R&&e.jsx(Qo,{open:R,onClose:()=>d(!1),all:o,run:s,onThresholdChange:j}),f&&e.jsx(tr,{open:f,onClose:()=>N(!1),dirHandle:_,currentFilename:c,onRestore:h,onMerge:S,SQL:g})]})}export{nr as default};
